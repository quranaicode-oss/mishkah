# Mishkah Pages Shell Roadmap

## Vision

تطوير طبقة `Pages.create` إلى تجربة إعداد موحدة تُعرِّف البيانات مرة واحدة ثم تُعرض في عدة قوالب (Templates) وثيمات دون تكرار. نهدف إلى جعل المطور يركز على وصف المحتوى، بينما تتولى المنصة إدارة التخطيط والتنسيق والتشغيل.

## بيانات أساسية موحَّدة

- **Page Classes**
  - مصفوفة من الكائنات بالشكل التالي:
    ```json
    {
      "key": "about",
      "class_name": {"ar": "عن مشكاة", "en": "About Mishkah"},
      "parent_id": null,
      "desc": {"ar": "تعريف بالفلسفة والرؤية", "en": "Philosophy and vision"},
      "sort": 1
    }
    ```
  - تسمح بالتدرج الشجري (parent_id يشير إلى عنصر آخر في نفس القائمة).
  - كل صفحة تشير إلى `class_key` لضمان التجميع الآلي داخل أي قالب.
  - نضيف `desc` اختياري للعرض في نتائج البحث والأقسام.

- **Pages**
  - كل صفحة تحتفظ بمفتاحها الفريد `page_key`، وربطها بـ `class_key`، مع `label` باللغتين و`desc` مختصر.
  - `data` يحتوي على كائنات مصنَّفة حسب `class_key` لتسهيل الوصول إلى البيانات الخاصة بكل قسم.
  - يتم توفير `dsl` أو `comp` حسب الحاجة، مع الالتزام بـ DSL.

- **Meta**
  - `env` يحتفظ بالثيم الافتراضي واللغة.
  - `themeLab` يظل خيارًا لتفعيل المختبر أو تعطيله.
  - `orders` تنقسم إلى:
    - أوامر عامّة (Theme / Lang / Search / Template Switcher).
    - أوامر خاصة بالصفحات (تنبع من الصفحات نفسها أو من الأقسام).

## قوالب العرض (Templates)

### 1. Sidebar Layout (الحالي)
- شريط جانبي يعرض الأقسام في شجرة مع إمكانية توسيعها.
- مساحة المحتوى تعرض الصفحة المختارة، مع رأس الصفحة يشمل اسم القسم والصفحة ووصف مختصر.

### 2. Top Navigation Layout
- قوائم عليا للأقسام الرئيسية، مع منسدلات للصفحات الفرعية.
- مناسب للتطبيقات المكتبية ذات المساحة الأفقية.

### 3. Blog / Knowledge Hub Layout
- صفحة رئيسية تُظهر بطاقات للأقسام (About, SDK, UI Components, Utils, Specialties).
- داخل القسم، قائمة مقالات/صفحات مع مقتطفات من `desc` ووسوم (Tags) مأخوذة من بيانات الصفحة.

### 4. SDK Gallery Layout
- يركّز على عرض الأمثلة التقنية كدليل مطوّر.
- يبرز الكود، الـ DSL، وروابط GitHub لكل مثال.
- يدعم عرض الشجرة في شريط جانبي ثانوي خاص بالأمثلة.

### 5. Top Tabs Layout
- Tabs علوية تمثل الأقسام الرئيسية.
- التبويب يدعم التمرير عند زيادة العدد.
- الصفحات الفرعية تظهر كبطاقات أو قائمة داخل التاب المفتوح.

### 6. Bottom Tabs Layout (Mobile)
- نسخة مخصصة للهاتف مع Tabs سفلية للأقسام.
- داخل كل تاب، يستخدم نفس بنية الصفحات مع مراعاة اللمس.

## تجربة البحث الموحدة

- زر واضح في الرأس (ضمن DefaultHeader أو Header مخصص) لفتح واجهة البحث.
- البحث يعمل على: عنوان الصفحة، اسم القسم، الوصف، الكلمات المفتاحية (إن وُجدت).
- النتائج تُعرض ضمن `Modal` أو صفحة خاصة، مع إبراز القسم الذي تنتمي إليه كل نتيجة.
- يمكن إضافة أمر `search:open`, `search:query`, `search:close` داخل أوامر النظام.

## تنظيم المحتوى حسب الأقسام المقترحة

1. **About Mishkah**
   - الوثيقة التقنية.
   - الوثيقة الأساسية.
   - فريق العمل.
   - أهداف الإطار ولماذا صُمم لخدمة المطور لا الشركات.

2. **UI Components**
   - عرض لكل مكون في `mishkah-ui.js`.
   - حالات الاستعمال، المتغيرات، وأمثلة DSL.
   - تبويب خاص لتجارب UI التخصصية (POS, KDS, ..).

3. **Utils & Tooling**
   - أمثلة استخدام الأدوات الأساسية والمتقدمة.
   - اختبارات صغيرة لإثبات الاعتمادية.

4. **Game Examples**
   - لعبة الأمثال الحالية.
   - لعبة المتوالية.
   - خطط لتوسعة أمثلة الألعاب (استخدام physics, timers, إلخ).

5. **SDK / Developer Guide**
   - أمثلة كود متكاملة تبني تطبيقات كاملة.
   - شرح لرحلة الإعداد من الصفر حتى النشر.

## Template Switcher UX

- عنصر في الرأس بجانب محول الثيم.
- واجهة صغيرة تعرض جميع القوالب المتاحة بصور مصغرة أو أسماء واضحة.
- كل تبديل يُعيد بناء التطبيق باستخدام نفس البيانات.
- يسمح للفرق بمراجعة التخطيط المناسب دون تعديل البيانات.
- يمكن تقييد القوالب حسب نوع الجهاز (مثلاً Tabs السفلية مخصصة للموبايل).

## توصيات هندسية

- الحفاظ على مصدر بيانات واحد في `database` لضمان الاتساق.
- استخدام `slots` لتخصيص أجزاء من القوالب دون إعادة بناء كل التخطيط.
- بناء أوامر مشتركة داخل `UI.orders` أو `Pages.orders` لدعم البحث والتبديل.
- توثيق كل قالب في ملف منفصل (مثلاً `templates/pages-sidebar.js`).
- الحفاظ على مسميات مفاتيح موحدة (`class_key`, `page_key`, `template_key`).

## خطوات التنفيذ المقترحة

1. تعريف بنية البيانات الجديدة (Page Classes + Pages + Data Map).
2. تحديث `Pages.create` للتعامل مع الأقسام وإعادة البناء الديناميكي للقوالب.
3. استخراج القوالب إلى ملفات مستقلة داخل `templates/` مع تسجيلها في `M.Templates`.
4. بناء Template Switcher مرتبط بالأوامر لتبديل `db.env.template`.
5. إضافة طبقة البحث وتكاملها مع القوالب (عرض النتائج حسب التخطيط).
6. إعداد أمثلة بيانات تغطي كل الأقسام المقترحة، لضمان أن جميع القوالب تعرض نفس المصدر بنجاح.
7. كتابة دليل للمطور يشرح كيفية إضافة قسم/صفحة/قالب جديد دون لمس بقية النظام.

## خلاصة

هذا المخطط يُبقي التركيز على "البيانات أولاً" ثم يسمح بتجريب عدة مخططات عرض بنفس المحتوى. النتيجة هي منصة أقل تشتتًا، أكثر اتساقًا، وتخدم المطوّر بتوفير قوالب جاهزة قابلة للتوسعة.
