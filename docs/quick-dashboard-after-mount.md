# Quick dashboard after-mount notes

## سبب تعطل الرسم قبل الإصلاح
- سكربتات لوحة المراقبة كانت محصورة داخل `<template id="quick-dashboard">`، وبالتالي لم تُنفَّذ عند تحميل الصفحة.
- الاستدعاء الوحيد لـ`quickDashboardMount` كان مُسجَّلاً كمستمع للأزرار، لذلك لم يبدأ تحضير الرسم حتى تفاعل المستخدم.

## ما الذي تغيَّر
- محرك HTMLx بات يجمع سمات `data-after-mount` من القالب ويجدولها بعد الإقلاع، مع تأخير آمن وقابل للتهيئة.
- قالب اللوحة يستخدم الآن `<script data-after-mount="quickDashboardMount" data-after-delay="16">` لربط التنفيذ بعد التركيب مباشرة.
- دالة `quickDashboardMount` تحفظ سياق تطبيق HTMLx، تعيد توصيل MishkahAuto، وتطلق `queueQuickDashboardHydration` فور توفر الحالة.

## لماذا تظهر البيانات فورًا الآن
- عند تركيب القالب يلتقط HTMLx بيانات `after-mount` ويشغّل الدالة المعنية، فتستفيد من الحالة المهيأة لتوليد البيانات واستدعاء مكتبة Chart.js دون انتظار ضغط الأزرار.

## ملاحظة بخصوص القيم العشوائية
- التابع `generateSalesSeries` يُنشئ القيم باستخدام انحرافات عشوائية حول خط أساس مشتق من السعر أو الإيرادات، ما يمنع ظهور أرقام ثابتة في كل تحميل.

