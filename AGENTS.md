# Mishkah Root Coding Guide

## Scope
هذه التعليمات تسري على كامل المستودع ما لم تُضف ملفات AGENTS.md أكثر تخصيصًا داخل مجلدات فرعية.

## المبادئ المعمارية
- التزم بمركزية الحالة: أي حالة يجب أن تعيش داخل كائن `database` الذي يُمرَّر إلى `setBody` والأوامر.
- عرِّف واجهاتك حصراً عبر DSL `M.DSL` ومكتبة `M.UI`; يمنع استخدام DOM يدوي أو قوالب خارجية.
- افصل بين العرض والسلوك: اربط التفاعلات عبر `gkey` داخل الخصائص، وعرّف منطقها داخل `app.setOrders`.
- استعن دائمًا بدوال `ctx.getState()`, `ctx.setState()`, `ctx.rebuild()` داخل الأوامر لتحديث الحالة بشكل متوقع.

## تنظيم المكوّنات
- قبل بناء تصميم جديد، افحص مكتبة `M.UI` وأضف لها مكونات معيارية قابلة لإعادة الاستخدام إن كان الاحتياج عامًا؛ لا تبنِ عناصر متخصصة مباشرة في الصفحات ما لم تكن حالة استثنائية.
- عند تعريف مكونات جديدة استخدم دوال تعيد عقد DSL، واحتفظ بالأجزاء المشتركة في وظائف صغيرة يسهل تركيبها.
- حافظ على i18n عبر `U.lang.makeLangLookup(db).TL(key)`، واستودع النصوص ضمن `db.i18n.dict` بمفاتيح `ar/en` كحد أدنى.

## الطقوس التشغيلية
- ابدأ أي صفحة جديدة بـ `Mishkah.app.setBody((db, D)=>VNode)` لتشكيل الجذر، ثم أكمل الإقلاع بـ `createApp`, `U.twcss.auto`, و`app.setOrders` قبل `app.mount('#app')`، تماماً كما في `index.html`.
- ادمج أوامر `M.UI.orders` و أوامر `U.twcss.auto(...).orders` مع أوامرك الخاصة لتفعيل السمات الافتراضية.
- استخدم `U.twcss.tw` أو `U.twcss.auto` لتجميع الأصناف، وتجنب سلاسل CSS اليدوية المطولة.

## الوصول والمرونة
- احرص على أن توفر المكونات غير الأصلية خصائص `role` و`tabIndex` عند الحاجة لضمان قابلية الوصول.
- عند التعامل مع نماذج/إدخالات، تأكد من وجود خصائص `name`, `value`, و`aria-*` المناسبة حسب الذرة المستخدمة.

باتباع هذه الإرشادات ستحافظ على نمطية الكود واتساقه مع فلسفة Mishkah الأساسية.