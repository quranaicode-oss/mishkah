<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mishkah Pages Template</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Tajawal:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        font-family: 'Tajawal', 'Cairo', system-ui, sans-serif;
      }
      body {
        margin: 0;
        background: radial-gradient(circle at top, rgba(79, 70, 229, 0.08), transparent 55%),
                    radial-gradient(circle at bottom, rgba(56, 189, 248, 0.12), transparent 60%),
                    #f5f7ff;
        color: #0f172a;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>

    <script src="./mishkah-utils.js"></script>
    <script src="./mishkah.core.js"></script>
    <script src="./mishkah-ui.js"></script>
    <script src="./template/pages-shell.js"></script>

    <script>
      (function setupSamplePages() {
        const M = window.Mishkah;
        const D = M.DSL;
        const UI = M.UI;
        const { tw } = M.utils.twcss;

        function HeaderShell(db) {
          const lang = (db.env && db.env.lang) || 'ar';
          const title = lang === 'ar' ? 'Ù„ÙˆØ­Ø© ØµÙØ­Ø§Øª Ø¬Ø§Ù‡Ø²Ø©' : 'Pages quick-start shell';
          const hint = lang === 'ar' ? 'Ø¨Ø¯Ù‘Ù„ Ø§Ù„Ù„ØºØ© Ø£Ùˆ Ø§Ù„Ø«ÙŠÙ… ÙÙˆØ±Ù‹Ø§' : 'Toggle language or theme instantly';
          return D.Containers.Div({
            attrs: { class: tw`mx-auto flex w-full max-w-6xl items-center justify-between px-4 py-4` }
          }, [
            D.Containers.Div({ attrs: { class: tw`flex flex-col gap-1` } }, [
              D.Text.Strong({ attrs: { class: tw`text-lg sm:text-xl` } }, [title]),
              D.Text.Span({ attrs: { class: tw`text-sm text-[var(--muted-foreground)]` } }, [hint])
            ]),
            D.Containers.Div({ attrs: { class: tw`flex items-center gap-2` } }, [
              UI.Button({ attrs: { gkey: 'ui:lang-ar' }, variant: 'ghost', size: 'sm' }, ['AR']),
              UI.Button({ attrs: { gkey: 'ui:lang-en' }, variant: 'ghost', size: 'sm' }, ['EN']),
              UI.Button({ attrs: { gkey: 'ui:theme-toggle' }, variant: 'ghost', size: 'sm' }, ['ğŸŒ“'])
            ])
          ]);
        }

        function FooterShell(db) {
          const year = new Date().getFullYear();
          const lang = (db.env && db.env.lang) || 'ar';
          const text = lang === 'ar' ? 'Ù‚Ø§Ù„Ø¨ Ù…Ø´ÙƒØ§Ø© â€” Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙˆØµÙŠÙ„' : 'Mishkah template â€” plug & play';
          return D.Containers.Div({
            attrs: { class: tw`mx-auto flex w-full max-w-6xl items-center justify-between px-4 py-4 text-sm` }
          }, [
            D.Text.Span({}, [`Â© ${year} ${text}`]),
            D.Text.A({
              attrs: {
                href: 'https://github.com/mishkah-js',
                target: '_blank',
                rel: 'noreferrer',
                class: tw`text-[var(--primary)] hover:underline`
              }
            }, ['Docs'])
          ]);
        }

        function OverviewPage(db) {
          const lang = (db.env && db.env.lang) || 'ar';
          const stats = [
            {
              title: lang === 'ar' ? 'Ø¬Ù„Ø³Ø§Øª Ù†Ø´Ø·Ø©' : 'Active sessions',
              value: '128',
              meta: lang === 'ar' ? '+12% Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹' : '+12% this week'
            },
            {
              title: lang === 'ar' ? 'Ø·Ù„Ø¨Ø§Øª Ù…ÙƒØªÙ…Ù„Ø©' : 'Completed orders',
              value: '2,310',
              meta: lang === 'ar' ? 'Ù…ØªÙˆØ³Ø· 45/ÙŠÙˆÙ…' : 'Avg 45/day'
            },
            {
              title: lang === 'ar' ? 'Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„' : 'Conversion rate',
              value: '8.6%',
              meta: lang === 'ar' ? '+1.4 Ù†Ù‚Ø·Ø©' : '+1.4 pts'
            }
          ];
          const statGrid = D.Containers.Div({ attrs: { class: tw`grid gap-4 sm:grid-cols-3` } },
            stats.map((item, index) => D.Containers.Div({ attrs: { key: `stat-${index}` } }, [
              UI.StatCard({ title: item.title, value: item.value, meta: item.meta })
            ]))
          );

          const actionLabel = lang === 'ar' ? 'ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù€ DSL' : 'Learn the DSL';
          const heroTitle = lang === 'ar'
            ? 'ÙƒÙˆÙ‘Ù† Ù„ÙˆØ­Ø© Ù…Ù† ØµÙØ­Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ø¨Ù…ØµÙÙˆÙØ© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·.'
            : 'Compose a multi-page workspace from a single array.';
          const heroDescription = lang === 'ar'
            ? 'Ù…Ø±Ø± Ø§Ù„Ù…ØµÙÙˆÙØ© ÙˆØ³ØªÙ‚ÙˆÙ… Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø¨Ø¨Ù†Ø§Ø¡ Ø§Ù„ØªÙ†Ù‚Ù„ØŒ ØªØ±ØªÙŠØ¨ Ø§Ù„ØµÙØ­Ø§ØªØŒ ÙˆØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.'
            : 'Pass the array and the shell wires navigation, ordering, and orders automatically.';

          return D.Containers.Div({ attrs: { class: tw`space-y-6` } }, [
            UI.Card({
              title: heroTitle,
              description: heroDescription,
              content: D.Containers.Div({ attrs: { class: tw`space-y-4` } }, [
                statGrid,
                D.Containers.Div({ attrs: { class: tw`flex flex-wrap items-center gap-3` } }, [
                  UI.Button({ attrs: { gkey: 'pages:go:reports' }, variant: 'solid', size: 'sm' }, ['ğŸ“Š ', lang === 'ar' ? 'Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±' : 'View reports']),
                  D.Text.A({
                    attrs: {
                      href: 'https://github.com/mishkah-js/mishkah',
                      target: '_blank',
                      rel: 'noreferrer',
                      class: tw`text-sm font-semibold text-[var(--primary)] hover:underline`
                    }
                  }, [`ğŸ”§ ${actionLabel}`])
                ])
              ])
            })
          ]);
        }

        function ReportsPage(db) {
          const lang = (db.env && db.env.lang) || 'ar';
          const rows = [
            { region: lang === 'ar' ? 'Ø§Ù„Ø´Ù…Ø§Ù„' : 'North', revenue: 'â‚ª 42,500', trend: '+12%' },
            { region: lang === 'ar' ? 'Ø§Ù„ÙˆØ³Ø·' : 'Central', revenue: 'â‚ª 38,120', trend: '+6%' },
            { region: lang === 'ar' ? 'Ø§Ù„Ø¬Ù†ÙˆØ¨' : 'South', revenue: 'â‚ª 19,870', trend: '-3%' }
          ];
          const note = lang === 'ar'
            ? 'Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ØªÙ…Ø«ÙŠÙ„ÙŠØ© â€” ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø­ÙŠØ© Ø¨Ø³Ù‡ÙˆÙ„Ø©.'
            : 'Sample figures â€” replace them with live data instantly.';

          return D.Containers.Div({ attrs: { class: tw`space-y-6` } }, [
            UI.Card({
              title: lang === 'ar' ? 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª' : 'Sales report',
              description: lang === 'ar'
                ? 'Ø¬Ø¯ÙˆÙ„ Ù…Ø¨Ù†ÙŠ Ø¨ÙˆØ§Ø³Ø·Ø© UI.Table Ù…Ø¹ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø¬Ø§Ù‡Ø².'
                : 'A table rendered with UI.Table and ready-made column mapping.',
              content: D.Containers.Div({ attrs: { class: tw`space-y-4` } }, [
                UI.Table({
                  columns: [
                    { key: 'region', label: lang === 'ar' ? 'Ø§Ù„Ù…Ù†Ø·Ù‚Ø©' : 'Region' },
                    { key: 'revenue', label: lang === 'ar' ? 'Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯' : 'Revenue' },
                    { key: 'trend', label: lang === 'ar' ? 'Ø§Ù„ØªØºÙŠØ±' : 'Change' }
                  ],
                  rows
                }),
                D.Text.Span({ attrs: { class: tw`text-xs text-[var(--muted-foreground)]` } }, [note])
              ])
            })
          ]);
        }

        window.MishkahPagesTemplate = {
          head: { title: 'Mishkah Pages Shell' },
          env: { theme: 'light', lang: 'ar', dir: 'rtl' },
          pages: [
            { key: 'overview', order: 1, icon: 'âœ¨', label: { ar: 'Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©', en: 'Overview' }, comp: 'OverviewPage' },
            { key: 'reports', order: 2, icon: 'ğŸ“Š', label: { ar: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±', en: 'Reports' }, comp: 'ReportsPage' },
            {
              key: 'settings',
              order: 3,
              icon: 'âš™ï¸',
              label: { ar: 'Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø³Ø±ÙŠØ¹Ø©', en: 'Quick settings' },
              dsl: function settingsDSL(db, helpers) {
                const lang = (db.env && db.env.lang) || 'ar';
                const { tw } = helpers;
                return D.Containers.Div({ attrs: { class: tw`space-y-4` } }, [
                  UI.Card({
                    title: lang === 'ar' ? 'ØªØ®ØµÙŠØµ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨' : 'Template preferences',
                    description: lang === 'ar'
                      ? 'ÙƒÙ„ Ø¹Ù†ØµØ± Ù‡Ù†Ø§ ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ø°Ø±Ø§Øª Ø§Ù„Ø±Ø³Ù…ÙŠØ© (Forms + Inputs).' 
                      : 'Every element here is assembled with the official DSL atoms.',
                    content: D.Containers.Div({ attrs: { class: tw`space-y-3` } }, [
                      UI.Field({
                        label: lang === 'ar' ? 'Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¨Ø±ÙŠØ¯' : 'Email notifications',
                        control: UI.Input({ attrs: { type: 'checkbox', checked: 'checked', disabled: 'disabled' } })
                      }),
                      UI.Field({
                        label: lang === 'ar' ? 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©' : 'Default language',
                        control: UI.Select({
                          attrs: { disabled: 'disabled', value: (db.env && db.env.lang) || 'ar' },
                          options: [
                            { value: 'ar', label: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' },
                            { value: 'en', label: 'English' }
                          ]
                        })
                      }),
                      UI.Button({ attrs: { gkey: 'pages:theme:lab:open' }, variant: 'solid', size: 'sm' }, ['ğŸ¨ ', lang === 'ar' ? 'ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù„ÙˆØ§Ù†' : 'Customize colors'])
                    ])
                  })
                ]);
              }
            }
          ],
          registry: {
            HeaderShell,
            FooterShell,
            OverviewPage,
            ReportsPage
          },
          slots: {
            header: 'HeaderShell',
            footer: 'FooterShell'
          },
          themeLab: {
            text: {
              button: { ar: 'Ù…Ø­Ø±Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù†', en: 'Theme lab' },
              title: { ar: 'ØªØ­ÙƒÙ… ÙÙŠ Ù…ØªØºÙŠØ±Ø§Øª CSS', en: 'Control CSS variables' },
              description: {
                ar: 'Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø«Ù… Ø§Ø­ÙØ¸Ù‡Ø§ Ø¹Ø¨Ø± Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©.',
                en: 'Adjust the key palette variables and persist them through the built-in orders.'
              },
              apply: { ar: 'Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª', en: 'Save changes' },
              reset: { ar: 'Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ', en: 'Reset defaults' }
            },
            vars: [
              { key: '--background', type: 'color' },
              { key: '--foreground', type: 'color' },
              { key: '--primary', type: 'color' },
              { key: '--primary-foreground', type: 'color' },
              { key: '--accent', type: 'color' },
              { key: '--accent-foreground', type: 'color' }
            ]
          }
        };

        if (!Array.isArray(window.PAGES)) {
          window.PAGES = window.MishkahPagesTemplate.pages.slice();
        }
        if (!window.PagesRegistry) {
          window.PagesRegistry = Object.assign({}, window.MishkahPagesTemplate.registry);
        }
      })();
    </script>

    <script>
      (function bootstrapPagesShell() {
        const M = window.Mishkah;
        const template = M.templates.PagesShell;
        const config = window.MishkahPagesTemplate || {};
        const pages = Array.isArray(config.pages) ? config.pages.slice() : [];
        const registry = Object.assign({}, config.registry || {});
        const head = Object.assign({ title: 'Mishkah Pages Shell' }, config.head || {});
        const env = Object.assign({ theme: 'light', lang: 'ar', dir: 'rtl' }, config.env || {});
        const active = config.active || (pages[0] && pages[0].key) || null;

        const database = {
          head,
          env,
          data: {
            pages,
            active,
            themeLab: config.themeLab || { enabled: true },
            slots: config.slots || {},
            registry
          },
          registry,
          slots: config.slots || {}
        };

        M.app.setBody(function renderApp(db) {
          db.head = head;
          return template.render(db);
        });

        const app = M.app.createApp(database, {});
        const templateOrders = template.createOrders(database);
        const auto = M.utils.twcss.auto(database, app);
        app.setOrders(Object.assign({}, templateOrders, M.UI.orders, auto.orders));
        app.mount('#app');
      })();
    </script>
  </body>
</html>
