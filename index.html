<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <title>ŸÖÿ¥ŸÉÿßÿ© ‚Äî ÿ™ÿ®ŸàŸäÿ®ÿßÿ™ + ŸÑÿπÿ®ÿ© ÿßŸÑÿ£ŸÖÿ´ÿßŸÑ</title>

  <script src="./mishkah-utils.js"></script>
  <script src="./mishkah.core.js"></script>
  <script src="./mishkah-ui.js"></script>
  <script src="./readme.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: light dark;
      --page-gradient: linear-gradient(160deg, #f8f9ff 0%, #e8ecff 100%);
      --page-overlay-1: radial-gradient(circle at 20% 25%, rgba(79, 70, 229, 0.18), transparent 55%);
      --page-overlay-2: radial-gradient(circle at 80% 70%, rgba(14, 165, 233, 0.18), transparent 50%);
      --panel-glass: rgba(255, 255, 255, 0.78);
      --panel-border: rgba(99, 102, 241, 0.12);
      --panel-shadow: 0 25px 50px -20px rgba(15, 23, 42, 0.18);
      --tile-bg: linear-gradient(160deg, rgba(255, 255, 255, 0.95), rgba(241, 245, 249, 0.85));
      --tile-bg-revealed: linear-gradient(160deg, rgba(129, 140, 248, 0.75), rgba(79, 70, 229, 0.65));
      --tile-border: rgba(99, 102, 241, 0.25);
      --letters-shadow: 0 18px 45px -24px rgba(15, 23, 42, 0.35);
      --letters-hover: 0 25px 50px -20px rgba(99, 102, 241, 0.45);
      --accent-ring: rgba(79, 70, 229, 0.18);
      --tile-size: 3.1rem;
      --user-font-scale: 100;
    }

    :root.dark {
      --page-gradient: linear-gradient(160deg, #0d1224 0%, #111c3d 100%);
      --page-overlay-1: radial-gradient(circle at 80% 30%, rgba(168, 85, 247, 0.22), transparent 55%);
      --page-overlay-2: radial-gradient(circle at 15% 80%, rgba(56, 189, 248, 0.18), transparent 55%);
      --panel-glass: rgba(17, 25, 40, 0.75);
      --panel-border: rgba(148, 163, 184, 0.32);
      --panel-shadow: 0 25px 50px -18px rgba(15, 23, 42, 0.55);
      --tile-bg: linear-gradient(160deg, rgba(30, 41, 59, 0.78), rgba(15, 23, 42, 0.92));
      --tile-bg-revealed: linear-gradient(160deg, rgba(99, 102, 241, 0.55), rgba(79, 70, 229, 0.38));
      --tile-border: rgba(148, 163, 184, 0.35);
      --letters-shadow: 0 20px 40px -18px rgba(148, 163, 184, 0.35);
      --letters-hover: 0 28px 60px -20px rgba(99, 102, 241, 0.6);
      --accent-ring: rgba(129, 140, 248, 0.35);
    }

    @media (min-width: 640px) {
      :root { --tile-size: 3.25rem; }
    }

    @media (min-width: 1024px) {
      :root { --tile-size: 3.4rem; }
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      height: 100vh;
      font-family: 'Tajawal', 'Cairo', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: calc(var(--user-font-scale) * 1%);
      background: var(--page-gradient);
      color: var(--foreground);
      position: relative;
      overflow: hidden;
      transition: background 0.45s ease, color 0.45s ease;
    }

    body::before,
    body::after {
      content: '';
      position: absolute;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      background: var(--page-overlay-1);
      mix-blend-mode: screen;
      animation: pulseNebula 18s ease-in-out infinite alternate;
    }

    body::after {
      background: var(--page-overlay-2);
      animation-delay: 6s;
    }

    #app {
      position: relative;
      z-index: 1;
    }

    .app-shell {
      min-height: 100vh;
      max-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .content-shell {
      flex: 1;
      min-height: 0;
      display: flex;
      overflow: hidden;
    }

    .main-region {
      flex: 1;
      min-height: 0;
      overflow-y: auto;
      padding-bottom: 4rem;
      scroll-behavior: smooth;
    }

    .glass-panel {
      background: var(--panel-glass);
      backdrop-filter: blur(26px) saturate(135%);
      border: 1px solid var(--panel-border);
      box-shadow: var(--panel-shadow);
      transition: border-color 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
    }

    .glow-outline {
      box-shadow: 0 0 0 1px var(--accent-ring), var(--panel-shadow);
    }

    .animate-float {
      animation: floatHalo 14s ease-in-out infinite;
    }

    .letter-tile {
      transition: transform 0.35s ease, box-shadow 0.35s ease, background 0.35s ease;
      border: 1px solid var(--tile-border);
      background: var(--tile-bg);
      color: var(--foreground);
      text-shadow: 0 2px 12px rgba(15, 23, 42, 0.2);
    }

    .letter-slot {
      width: var(--tile-size);
      height: var(--tile-size);
    }

    .letter-space {
      width: calc(var(--tile-size) * 0.5);
      height: var(--tile-size);
    }

    .letter-tile[data-revealed="true"] {
      transform: translateY(-6px) scale(1.03);
      box-shadow: 0 18px 40px -22px rgba(79, 70, 229, 0.55);
      background: var(--tile-bg-revealed);
      color: #fff;
    }

    .letters-grid button {
      transition: transform 0.25s ease, box-shadow 0.25s ease, opacity 0.25s ease;
      box-shadow: var(--letters-shadow);
      font-size: 1.25rem;
      font-weight: 700;
      border-radius: 0.9rem !important;
      height: var(--tile-size);
      min-height: var(--tile-size);
      min-width: var(--tile-size);
    }

    .letters-grid button:hover:not([disabled]) {
      transform: translateY(-5px) scale(1.03);
      box-shadow: var(--letters-hover);
    }

    .letters-grid button[disabled] {
      opacity: 0.35;
      cursor: not-allowed;
    }

    .md-prose {
      line-height: 1.8;
      font-size: 1rem;
      color: var(--foreground);
    }

    .md-prose h1,
    .md-prose h2,
    .md-prose h3,
    .md-prose h4,
    .md-prose h5,
    .md-prose h6 {
      font-family: 'Cairo', 'Tajawal', system-ui, sans-serif;
      font-weight: 700;
      letter-spacing: 0.01em;
      color: color-mix(in oklab, var(--foreground) 92%, var(--primary) 8%);
      margin: 1.6em 0 0.8em;
    }

    .md-prose p {
      margin: 1em 0;
      color: color-mix(in oklab, var(--foreground) 88%, var(--muted-foreground) 12%);
    }

    .md-prose ul,
    .md-prose ol {
      margin: 1em 0;
      padding-inline-start: 1.4em;
      display: flex;
      flex-direction: column;
      gap: 0.5em;
    }

    .md-prose li {
      position: relative;
      padding-inline-start: 0.3em;
    }

    .md-prose blockquote {
      margin: 1.2em 0;
      padding: 1.2em 1.5em;
      border-inline-start: 4px solid color-mix(in oklab, var(--primary) 80%, transparent);
      background: color-mix(in oklab, var(--surface-1) 80%, transparent);
      border-radius: 1.2rem;
      color: color-mix(in oklab, var(--foreground) 80%, var(--muted-foreground) 20%);
      box-shadow: 0 12px 30px -24px rgba(79, 70, 229, 0.45);
    }

    .md-prose pre {
      margin: 1.4em 0;
      padding: 1.2em 1.4em;
      border-radius: 1.2rem;
      background: color-mix(in oklab, var(--surface-2) 88%, transparent);
      box-shadow: 0 24px 45px -24px rgba(15, 23, 42, 0.45);
      overflow-x: auto;
      font-size: 0.92rem;
      direction: ltr;
      text-align: left;
    }

    .md-prose code {
      font-family: 'Fira Code', 'IBM Plex Mono', 'Cascadia Code', monospace;
      background: color-mix(in oklab, var(--surface-2) 85%, transparent);
      padding: 0.15em 0.4em;
      border-radius: 0.5em;
      font-size: 0.92em;
    }

    .md-prose pre code {
      background: transparent;
      padding: 0;
    }

    .md-prose table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5em 0;
      border-radius: 1.2rem;
      overflow: hidden;
      box-shadow: 0 18px 45px -25px rgba(15, 23, 42, 0.35);
    }

    .md-prose thead {
      background: color-mix(in oklab, var(--surface-2) 55%, var(--primary) 45%);
      color: color-mix(in oklab, var(--primary-foreground) 65%, var(--foreground) 35%);
    }

    .md-prose th,
    .md-prose td {
      padding: 0.85em 1em;
      border: 1px solid color-mix(in oklab, var(--border) 60%, transparent);
      text-align: start;
    }

    .md-prose tbody tr:nth-child(even) {
      background: color-mix(in oklab, var(--surface-1) 80%, transparent);
    }

    .md-prose img {
      max-width: 100%;
      height: auto;
      display: inline-block;
      vertical-align: middle;
    }

    .settings-tile {
      border-radius: 1.5rem;
      padding: 1rem 1.25rem;
      background: color-mix(in oklab, var(--surface-2) 70%, transparent);
      border: 1px solid color-mix(in oklab, var(--border) 55%, transparent);
      box-shadow: 0 12px 35px -22px rgba(15, 23, 42, 0.35);
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.75rem;
    }

    .toggle-switch {
      position: relative;
      width: 3.25rem;
      height: 1.65rem;
    }

    .toggle-switch input {
      appearance: none;
      -webkit-appearance: none;
      width: 100%;
      height: 100%;
      border-radius: 999px;
      background: color-mix(in oklab, var(--surface-2) 88%, transparent);
      border: 1px solid color-mix(in oklab, var(--border) 65%, transparent);
      position: relative;
      cursor: pointer;
      transition: background 0.25s ease, border-color 0.25s ease;
    }

    .toggle-switch input::after {
      content: '';
      position: absolute;
      inset-inline-start: 0.2rem;
      top: 0.18rem;
      width: 1.25rem;
      height: 1.25rem;
      border-radius: 50%;
      background: color-mix(in oklab, var(--muted-foreground) 30%, white 70%);
      box-shadow: 0 10px 18px -10px rgba(15, 23, 42, 0.35);
      transition: transform 0.25s ease, background 0.25s ease;
    }

    .toggle-switch input:checked {
      background: color-mix(in oklab, var(--primary) 30%, transparent);
      border-color: color-mix(in oklab, var(--primary) 70%, transparent);
    }

    .toggle-switch input:checked::after {
      transform: translateX(1.55rem);
      background: var(--primary);
    }

    .game-panel {
      position: relative;
    }

    .game-board {
      position: relative;
      transition: transform 0.35s ease;
    }

    .puzzle-row {
      animation-duration: 0.6s;
      animation-timing-function: ease-in-out;
    }

    .game-board.feedback-correct .puzzle-row {
      animation-name: tilePop;
    }

    .game-board.feedback-wrong .puzzle-row {
      animation-name: tileShake;
    }

    .game-board.feedback-win .puzzle-row {
      animation-name: tileCelebrate;
    }

    .game-board.feedback-lose .puzzle-row {
      animation-name: tileFade;
    }

    .celebration-card,
    .gameover-card {
      position: relative;
      overflow: hidden;
    }

    .celebration-card::after {
      content: '';
      position: absolute;
      inset: -40%;
      background: radial-gradient(circle at 50% 20%, rgba(79, 70, 229, 0.25), transparent 55%);
      opacity: 0.8;
      animation: pulseNebula 8s ease-in-out infinite;
      pointer-events: none;
    }

    .gameover-card::after {
      content: '';
      position: absolute;
      inset: -30%;
      background: radial-gradient(circle at 50% 80%, rgba(239, 68, 68, 0.25), transparent 65%);
      opacity: 0.7;
      animation: overlayPulse 6s ease-in-out infinite;
      pointer-events: none;
    }

    .game-overlay-content {
      position: relative;
      z-index: 1;
    }

    .confetti-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 25;
    }

    .confetti-piece {
      position: absolute;
      top: -10vh;
      width: 0.55rem;
      height: 1.6rem;
      border-radius: 999px;
      opacity: 0;
      animation: confettiFall 3.6s ease-in forwards;
    }

    .confetti-piece:nth-child(odd) {
      animation-duration: 4s;
    }

    .md-prose a {
      color: var(--primary);
      text-decoration: none;
      border-bottom: 1px solid color-mix(in oklab, var(--primary) 65%, transparent);
      transition: color 0.2s ease, border-color 0.2s ease;
    }

    .md-prose a:hover {
      color: color-mix(in oklab, var(--primary) 90%, black);
      border-color: currentColor;
    }

    .md-prose hr {
      margin: 2.5em 0;
      border: none;
      border-top: 1px dashed color-mix(in oklab, var(--border) 65%, transparent);
    }

    @keyframes floatHalo {
      0%, 100% { transform: translate3d(0, 0, 0); }
      50% { transform: translate3d(0, -18px, 0) scale(1.01); }
    }

    @keyframes pulseNebula {
      0% { opacity: 0.45; }
      50% { opacity: 0.75; }
      100% { opacity: 0.45; }
    }

    @keyframes tilePop {
      0% { transform: scale(0.94); }
      40% { transform: scale(1.06); }
      100% { transform: scale(1); }
    }

    @keyframes tileShake {
      0%, 100% { transform: translateX(0); }
      20% { transform: translateX(-8px); }
      40% { transform: translateX(8px); }
      60% { transform: translateX(-6px); }
      80% { transform: translateX(6px); }
    }

    @keyframes tileCelebrate {
      0% { transform: translateY(0) scale(1); }
      30% { transform: translateY(-10px) scale(1.05); }
      70% { transform: translateY(4px) scale(0.98); }
      100% { transform: translateY(0) scale(1); }
    }

    @keyframes tileFade {
      0% { opacity: 1; }
      100% { opacity: 0.6; }
    }

    @keyframes overlayPulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.6; }
    }

    @keyframes confettiFall {
      0% { opacity: 0; transform: translate3d(0, -20vh, 0) rotate(0deg); }
      10% { opacity: 1; }
      100% { opacity: 0; transform: translate3d(0, 110vh, 0) rotate(360deg); }
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
  (function(){
    const M = Mishkah, U = M.utils, UI = M.UI, D = M.DSL;
    const { tw } = U.twcss;
    const { makeLangLookup } = U.lang;

    /*
    ================================================================
    |                                                              |
    |      ÿ®ÿ≥ŸÖ ÿßŸÑŸÑŸá ÿßŸÑÿ±ÿ≠ŸÖŸÜ ÿßŸÑÿ±ÿ≠ŸäŸÖ: ÿ±ÿ≠ŸÑÿ© ÿßŸÑÿÆŸÑŸÇ ŸÅŸä "ŸÖÿ¥ŸÉÿßÿ©"             |
    |                                                              |
    ================================================================
    |
    | ÿ•ŸÜ ÿ®ŸÜÿßÿ° Ÿáÿ∞ÿß ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ŸÑŸäÿ≥ ŸÖÿ¨ÿ±ÿØ ŸÉÿ™ÿßÿ®ÿ© ŸÉŸàÿØÿå ÿ®ŸÑ ŸáŸà ŸÖÿ≠ÿßŸÉÿßÿ© ŸÑÿ±ÿ≠ŸÑÿ©
    | ÿßŸÑÿÆŸÑŸÇ ŸàÿßŸÑÿ™ŸÉŸàŸäŸÜ ŸÉŸÖÿß ÿ™ÿµŸÅŸáÿß ŸÅŸÑÿ≥ŸÅÿ© "ŸÖÿ¥ŸÉÿßÿ©". ÿ≥ŸÜŸÖÿ± ÿ®ŸÖÿ±ÿ≠ŸÑÿ™ŸäŸÜ
    | ÿ£ÿ≥ÿßÿ≥Ÿäÿ™ŸäŸÜÿå ŸÉŸÑ ŸÖÿ±ÿ≠ŸÑÿ© ÿ™ÿ™ŸÉŸàŸÜ ŸÖŸÜ ÿ≤Ÿàÿ¨ŸäŸÜ:
    |
    | 1. ÿßŸÑÿ≤Ÿàÿ¨ ÿßŸÑÿ£ŸàŸÑ: ÿßŸÑÿ™ÿµŸÖŸäŸÖ ŸàÿßŸÑÿ™ÿ≥ŸàŸäÿ© (ÿ™ÿÆÿ∑Ÿäÿ∑ ÿßŸÑÿ¨ÿ≥ÿØ)
    |    - ÿßŸÑÿ±ŸÉŸÜ ÿßŸÑÿ£ŸàŸÑ: ÿßŸÑÿ∑ŸäŸÜ ŸàÿßŸÑÿ∞ÿ±ÿßÿ™ (Atoms as Components)
    |    - ÿßŸÑÿ±ŸÉŸÜ ÿßŸÑÿ´ÿßŸÜŸä: ÿßŸÑÿπŸÑŸÖ ÿßŸÑŸÅÿ∑ÿ±Ÿä (database as DNA)
    |    ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©: ÿ¨ÿ≥ÿØ ŸÖŸèÿµŸàŸëŸéÿ± (VDOM) ŸÇÿ®ŸÑ ŸÜŸÅÿÆ ÿßŸÑÿ±Ÿàÿ≠.
    |
    | 2. ÿßŸÑÿ≤Ÿàÿ¨ ÿßŸÑÿ´ÿßŸÜŸä: ÿßŸÑÿ™ŸÖŸÉŸäŸÜ ŸàÿßŸÑÿ™ŸÉŸÑŸäŸÅ (ŸÜŸÅÿÆ ÿßŸÑÿ±Ÿàÿ≠ ŸàÿßŸÑÿ≠Ÿäÿßÿ©)
    |    - ÿßŸÑÿ±ŸÉŸÜ ÿßŸÑÿ£ŸàŸÑ: ÿßŸÑÿ•ŸäŸÖÿßŸÜ (database as State)
    |    - ÿßŸÑÿ±ŸÉŸÜ ÿßŸÑÿ´ÿßŸÜŸä: ÿßŸÑÿπŸÖŸÑ ÿßŸÑÿµÿßŸÑÿ≠ (Orders)
    |    ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©: ŸÉÿßÿ¶ŸÜ ÿ≠Ÿä ŸÖÿ™ŸÉÿßŸÖŸÑ Ÿäÿ™ŸÅÿßÿπŸÑ ŸàŸäÿ≥ÿ™ÿ¨Ÿäÿ®.
    |
    */

    // ================================================================
    // ÿßŸÑŸÖÿ±ÿ≠ŸÑÿ© ÿßŸÑÿ™ŸÖŸáŸäÿØŸäÿ©: ÿ¨ŸÖÿπ ÿßŸÑŸÖÿßÿØÿ© ÿßŸÑÿÆÿßŸÖ ŸÑŸÑŸÖÿπÿ±ŸÅÿ©
    // ŸÇÿ®ŸÑ ÿßŸÑÿÆŸÑŸÇÿå ŸÜÿ¨ŸÖÿπ ŸÉŸÑ ÿßŸÑŸÖŸàÿßÿØ ÿßŸÑÿ£ŸàŸÑŸäÿ©: ÿßŸÑŸÜÿµŸàÿµÿå ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ÿå ŸàÿßŸÑŸÇŸàÿßÿπÿØ.
    // ================================================================

    /* ===================== i18n: ÿßŸÑŸÖÿπÿßÿ¨ŸÖ ÿßŸÑŸÑÿ∫ŸàŸäÿ© ===================== */
    const dict = {
      'app.title'   : { ar:'ŸÖÿ¥ŸÉÿßÿ© ‚Äî ŸÖÿ¥ŸÉÿßÿ© ÿßŸÑŸÜŸàÿ± ŸàŸÑÿπÿ®ÿ© ÿßŸÑÿ£ŸÖÿ´ÿßŸÑ', en:'Mishkah ‚Äî Lighthouse Docs & Proverbs Game' },
      'header.subtitle': { ar:'ŸÖÿ±ÿ¨ÿπ ÿßŸÑŸÜŸàÿ± Ÿäÿ¨ŸÖÿπ ÿßŸÑŸàÿ´ÿßÿ¶ŸÇÿå ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ÿå ŸàŸÑÿπÿ®ÿ© ÿßŸÑÿ£ŸÖÿ´ÿßŸÑ ŸÅŸä ŸÑŸàÿ≠ÿ© Ÿàÿßÿ≠ÿØÿ© Ÿàÿßÿ≥ÿπÿ©.', en:'A radiant hub that unifies the docs, controls, and the Proverbs game in a spacious canvas.' },
      'settings.toggleLabel': { ar:'ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™', en:'Show controls' },
      'settings.switch.on': { ar:'ŸÖŸÅÿπŸëŸÑÿ©', en:'Visible' },
      'settings.switch.off': { ar:'ŸÖÿÆŸÅŸäÿ©', en:'Hidden' },
      'settings.title': { ar:'ŸÑŸàÿ≠ÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ©', en:'Intelligent Control Center' },
      'settings.description': { ar:'ÿßÿ∂ÿ®ÿ∑ ÿ™ÿ¨ÿ±ÿ®ÿ© ÿßŸÑŸÑÿπÿ®ÿ© ŸàÿßŸÑÿ´ŸäŸÖ Ÿàÿßÿ≠ÿ™ŸÅÿ∏ ÿ®ÿ™ŸÅÿ∂ŸäŸÑÿßÿ™ŸÉ ÿπŸÑŸâ ŸÜŸÅÿ≥ ÿßŸÑÿ¨Ÿáÿßÿ≤.', en:'Tune the game experience and theming, and keep your preferences on this device.' },
      'settings.gameSection': { ar:'ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©', en:'Game Settings' },
      'settings.themeSection': { ar:'ÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿ´ŸäŸÖ', en:'Theme Options' },
      'settings.backgroundLabel': { ar:'ÿÆŸÑŸÅŸäÿ© ÿßŸÑÿµŸÅÿ≠ÿ©', en:'Page background' },
      'settings.textLabel': { ar:'ÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÜÿµ ŸàÿßŸÑÿπŸÜÿßÿµÿ±', en:'Text & accent colors' },
      'settings.fontLabel': { ar:'ÿ≠ÿ¨ŸÖ ÿßŸÑÿÆÿ∑', en:'Font size' },
      'settings.previewLabel': { ar:'ŸÖÿπÿßŸäŸÜÿ© ŸÅŸàÿ±Ÿäÿ©', en:'Live preview' },
      'settings.previewHint': { ar:'ÿ≥ÿ™ÿ™ÿ≠ÿØÿ´ ÿßŸÑÿ™ÿ∫ŸäŸäÿ±ÿßÿ™ ŸÑÿ≠ÿ∏ŸäŸãÿß Ÿàÿ™ÿ≠ŸÅÿ∏ ŸÅŸä ÿßŸÑŸÖÿ™ÿµŸÅÿ≠.', en:'Changes update instantly and are stored in the browser.' },
      'settings.reset': { ar:'ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©', en:'Reset to defaults' },
      'settings.close': { ar:'ÿ•ÿ∫ŸÑÿßŸÇ', en:'Close' },
      'designLab.openButton': { ar:'ŸÖÿÆÿ™ÿ®ÿ± ÿßŸÑÿ£ŸÑŸàÿßŸÜ', en:'Design Lab' },
      'designLab.title': { ar:'ŸÖÿÆÿ™ÿ®ÿ± ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑŸàÿßÿ¨Ÿáÿ©', en:'Interface Design Lab' },
      'designLab.subtitle': { ar:'ÿ™ÿ≠ŸÉŸÖ ÿ®ÿ¨ŸÖŸäÿπ ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ CSS ŸÖŸÜ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ŸàÿßŸÑÿ£ÿ≠ÿ¨ÿßŸÖ ŸÖÿπ ŸÖÿπÿßŸäŸÜÿ© ŸÅŸàÿ±Ÿäÿ©.', en:'Control every CSS variable‚Äîfrom colors to sizes‚Äîwith live preview.' },
      'designLab.themeTitle': { ar:'ÿ£Ÿàÿ∂ÿßÿπ ÿßŸÑÿ´ŸäŸÖ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ©', en:'Quick Theme Modes' },
      'designLab.mode.light': { ar:'Ÿàÿ∂ÿπ ŸÖÿ∂Ÿäÿ°', en:'Light Glow' },
      'designLab.mode.dark': { ar:'Ÿàÿ∂ÿπ ŸÑŸäŸÑŸä', en:'Nightfall' },
      'designLab.mode.pink': { ar:'Ÿàÿ∂ÿπ Ÿàÿ±ÿØŸä', en:'Pink Aurora' },
      'designLab.modeHint': { ar:'ÿßÿÆÿ™ÿ± Ÿàÿ∂ÿπŸãÿß ÿ´ŸÖ ÿÆÿµÿµ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ ÿ£ÿØŸÜÿßŸá.', en:'Pick a mode, then fine-tune every detail below.' },
      'designLab.resetAll': { ar:'ÿ•ÿπÿßÿØÿ© ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™', en:'Reset All Variables' },
      'designLab.resetVar': { ar:'ÿ•ÿ±ÿ¨ÿßÿπ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä', en:'Revert Default' },
      'designLab.currentValue': { ar:'ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©', en:'Current value' },
      'designLab.defaultValue': { ar:'ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©', en:'Default value' },
      'designLab.group.core': { ar:'ÿ£ŸÑŸàÿßŸÜ ÿ¨ŸàŸáÿ±Ÿäÿ©', en:'Core Colors' },
      'designLab.group.coreHint': { ar:'ÿßÿ∂ÿ®ÿ∑ ÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÜÿµ ŸàÿßŸÑÿπŸÜÿßÿµÿ± ÿßŸÑÿ®ÿßÿ±ÿ≤ÿ©.', en:'Tweak the primary text and accent colors.' },
      'designLab.group.surface': { ar:'ÿÆŸÑŸÅŸäÿßÿ™ Ÿàÿ∑ÿ®ŸÇÿßÿ™', en:'Backgrounds & Layers' },
      'designLab.group.surfaceHint': { ar:'ÿÆÿµÿµ ÿßŸÑÿÆŸÑŸÅŸäÿßÿ™ ŸàÿßŸÑÿ∑ÿ®ŸÇÿßÿ™ ÿßŸÑÿ≤ÿ¨ÿßÿ¨Ÿäÿ© ŸàÿßŸÑÿ≠ÿØŸàÿØ.', en:'Customize page backdrops, glass layers, and borders.' },
      'designLab.group.effects': { ar:'ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿ®ÿµÿ±Ÿäÿ©', en:'Visual Effects' },
      'designLab.group.effectsHint': { ar:'ÿ™ÿ≠ŸÉŸÖ ÿ®ÿßŸÑÿ∏ŸÑÿßŸÑ ŸàÿßŸÑÿ™ŸàŸáÿ¨ÿßÿ™ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑŸÑÿπÿ®.', en:'Control shadows and glows used across the game.' },
      'designLab.group.sizing': { ar:'ÿ£ÿ≠ÿ¨ÿßŸÖ ÿßŸÑÿπŸÜÿßÿµÿ±', en:'Element Sizing' },
      'designLab.group.sizingHint': { ar:'ÿ∂ÿ®ÿ∑ ÿ£ÿ≠ÿ¨ÿßŸÖ ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™ ŸàŸÜÿ≥ÿ®ÿ© ÿßŸÑÿÆÿ∑.', en:'Adjust tile sizes and the global font scale.' },
      'designLab.var.foreground': { ar:'ŸÑŸàŸÜ ÿßŸÑŸÜÿµ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä', en:'Primary text color' },
      'designLab.var.muted': { ar:'ŸÑŸàŸÜ ÿßŸÑŸÜÿµ ÿßŸÑÿ´ÿßŸÜŸàŸä', en:'Muted text color' },
      'designLab.var.primary': { ar:'ŸÑŸàŸÜ ÿßŸÑÿ™ŸÖŸäŸäÿ≤ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä', en:'Primary accent color' },
      'designLab.var.primaryForeground': { ar:'ŸÑŸàŸÜ ÿßŸÑŸÜÿµ ŸÅŸàŸÇ ÿßŸÑÿ™ŸÖŸäŸäÿ≤', en:'Text on primary' },
      'designLab.var.accentRing': { ar:'ŸàŸáÿ¨ ÿßŸÑÿ≠ŸàÿßŸÅ', en:'Accent ring glow' },
      'designLab.var.gradient': { ar:'ÿ™ÿØÿ±ÿ¨ ÿÆŸÑŸÅŸäÿ© ÿßŸÑÿµŸÅÿ≠ÿ©', en:'Page gradient' },
      'designLab.var.overlay1': { ar:'ÿ∑ÿ®ŸÇÿ© ÿ∂Ÿàÿ¶Ÿäÿ© ÿ£ŸàŸÑŸâ', en:'First light overlay' },
      'designLab.var.overlay2': { ar:'ÿ∑ÿ®ŸÇÿ© ÿ∂Ÿàÿ¶Ÿäÿ© ÿ´ÿßŸÜŸäÿ©', en:'Second light overlay' },
      'designLab.var.panelGlass': { ar:'ŸÑŸàŸÜ ÿßŸÑŸÑŸàÿ≠ ÿßŸÑÿ≤ÿ¨ÿßÿ¨Ÿä', en:'Glass panel tint' },
      'designLab.var.panelBorder': { ar:'ŸÑŸàŸÜ ÿ≠ÿØŸàÿØ ÿßŸÑŸÑŸàÿ≠', en:'Panel border color' },
      'designLab.var.tileBg': { ar:'ÿÆŸÑŸÅŸäÿ© ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™', en:'Tile background' },
      'designLab.var.tileRevealed': { ar:'ÿÆŸÑŸÅŸäÿ© ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™ ÿßŸÑŸÖŸÉÿ¥ŸàŸÅÿ©', en:'Revealed tile background' },
      'designLab.var.tileBorder': { ar:'ÿ≠ÿØŸàÿØ ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™', en:'Tile border color' },
      'designLab.var.lettersShadow': { ar:'ÿ∏ŸÑ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ≠ÿ±ŸàŸÅ', en:'Letter buttons shadow' },
      'designLab.var.lettersHover': { ar:'ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ™ÿ≠ŸàŸäŸÖ ŸÑŸÑÿ≠ÿ±ŸàŸÅ', en:'Letter hover effect' },
      'designLab.var.tileSize': { ar:'ÿ≠ÿ¨ŸÖ ÿßŸÑÿ®ŸÑÿßÿ∑ÿßÿ™', en:'Tile size' },
      'designLab.var.fontScale': { ar:'ŸÖŸÇŸäÿßÿ≥ ÿßŸÑÿÆÿ∑ ÿßŸÑÿπÿßŸÖ', en:'Global font scale' },
      'nav.menu'       : { ar:'ÿßŸÑÿ™ŸÜŸÇŸÑ', en:'Navigation' },
      'nav.readmeBase' : { ar:'ŸÖÿ¥ŸÉÿßÿ© ÿßŸÑŸÜŸàÿ± ŸàÿßŸÑÿ∞ŸÉÿ± ÿßŸÑÿ£ÿπŸÑŸâ', en:'Mishkah of Light & Highest Remembrance' },
      'nav.readmeTec'  : { ar:'Ÿàÿ´ŸäŸÇÿ© ŸÖÿ¥ŸÉÿßÿ© ÿßŸÑÿ™ŸÇŸÜŸäÿ©', en:'Mishkah Technical Charter' },
      'nav.counter'    : { ar:'ÿßŸÑÿπÿØÿßÿØ', en:'Counter' },
      'nav.game'       : { ar:'ŸÑÿπÿ®ÿ© ÿßŸÑÿ£ŸÖÿ´ÿßŸÑ', en:'Proverbs Game' },
      'nav.logic'      : { ar:'ÿ™ÿ≠ÿØŸä ÿßŸÑÿ∞ŸÉÿßÿ°', en:'Logic Trainer' },
      'doc.base.lead'  : { ar:'ÿ±ÿ≠ŸÑÿ© ŸÅŸÑÿ≥ŸÅÿ© ŸÖÿ¥ŸÉÿßÿ© ŸàŸÖŸÜŸáÿ¨ ÿßŸÑÿ∞ŸÉÿ± ÿßŸÑÿ£ÿπŸÑŸâ ÿßŸÑÿ∞Ÿä ÿ£ŸÑŸáŸÖ ÿ™ÿµŸÖŸäŸÖŸáÿß.', en:'The philosophical journey behind Mishkah and the higher remembrance that inspires it.' },
      'doc.tec.lead'   : { ar:'ÿßŸÑÿØŸÑŸäŸÑ ÿßŸÑÿ™ŸÇŸÜŸä ÿßŸÑŸÉÿßŸÖŸÑ ŸÑŸÖÿπŸÖÿßÿ±Ÿäÿ© ŸÖÿ¥ŸÉÿßÿ© ŸàŸÖÿ≠ÿ±ŸÉŸáÿß ÿßŸÑÿ™ÿπÿ±ŸäŸÅŸä.', en:'The complete technical dossier for Mishkah‚Äôs architecture and declarative engine.' },
      'doc.language.hint': { ar:'ÿ®ÿØŸëŸÑ ÿßŸÑŸÑÿ∫ÿ© ŸÖŸÜ ÿßŸÑÿ£ÿπŸÑŸâ ŸÑÿ™ŸÇÿ±ÿ£ ÿßŸÑŸàÿ´ŸäŸÇÿ© ÿ®ŸÑÿ∫ÿ™ŸÉ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ©.', en:'Use the header controls to switch between Arabic and English.' },
      'counter.title'  : { ar:'ÿπÿØÿßÿØ ÿ®ÿ≥Ÿäÿ∑', en:'Simple Counter' },
      'counter.reset'  : { ar:'ÿ•ÿπÿßÿØÿ©', en:'Reset' },
      'game.title'     : { ar:'ŸÑÿπÿ®ÿ© ÿßŸÑÿ£ŸÖÿ´ÿßŸÑ Ÿà ÿßŸÑÿ≠ŸÉŸÖ', en:'Proverbs & Wisdom Game' },
      'game.music'     : { ar:'ÿßŸÑŸÖŸàÿ≥ŸäŸÇŸâ ÿßŸÑÿ∫ÿßŸÖÿ±ÿ©', en:'Mystery Music' },
      'game.timer'     : { ar:'ŸÖÿ§ŸÇÿ™ ÿßŸÑÿ™ÿπŸÑŸÖ', en:'Learning Timer' },
      'game.seconds'   : { ar:'ÿ´', en:'s' },
      'game.start'     : { ar:'ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ®ÿ©', en:'Start Game' },
      'game.new'       : { ar:'ŸÖÿ´ŸÑ ÿ¨ÿØŸäÿØ', en:'New Proverb' },
      'game.tries'     : { ar:'ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™ ÿßŸÑŸÖÿ™ÿ®ŸÇŸäÿ©', en:'Tries Left' },
      'game.hintTitle' : { ar:'ÿßŸÑÿ™ŸÑŸÖŸäÿ≠ ÿßŸÑÿ™ÿπŸÑŸäŸÖŸä', en:'Educational Hint' },
      'game.win'       : { ar:'ÿ±ÿ®ÿ≠ÿ™! üéâ', en:'You won! üéâ' },
      'game.lose'      : { ar:'ŸÑŸÑÿ£ÿ≥ŸÅ ÿÆÿ≥ÿ±ÿ™ üôà', en:'You lost üôà' },
      'game.reveal'    : { ar:'ÿßŸÉÿ™ÿ¥ŸÅ ÿßŸÑÿ≠ŸÉŸÖÿ©', en:'Reveal Wisdom' },
      'game.solution'  : { ar:'ÿßŸÑÿ≠ŸÑ ÿßŸÑŸÉÿßŸÖŸÑ', en:'Full Solution' },
      'game.explanation':{ ar:'ÿ¥ÿ±ÿ≠ ÿßŸÑŸÖÿ´ŸÑ', en:'Explanation' },
      'game.lesson'    : { ar:'ŸÖÿß ŸÜÿ™ÿπŸÑŸÖŸá', en:'Key Lesson' },
      'game.source'    : { ar:'ÿßŸÑŸÖÿµÿØÿ±', en:'Source' },
      'game.timeLabel' : { ar:'ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä', en:'Time Left' },
      'game.letters'   : { ar:'ÿßŸÑÿ£ÿ≠ÿ±ŸÅ ÿßŸÑŸÖÿ™ÿßÿ≠ÿ©', en:'Available Letters' },
      'game.statusLabel': { ar:'ÿ≠ÿßŸÑÿ© ÿßŸÑŸÑÿπÿ®ÿ©', en:'Game Status' },
      'game.settingsButton': { ar:'ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©', en:'Game Settings' },
      'game.status.idle': { ar:'ÿ¨ÿßŸáÿ≤ÿ©', en:'Ready' },
      'game.status.running': { ar:'ŸÇŸäÿØ ÿßŸÑŸÑÿπÿ®', en:'In Progress' },
      'game.status.won' : { ar:'ÿßŸÜÿ™ÿµÿßÿ±', en:'Victory' },
      'game.status.lost': { ar:'ÿÆÿ≥ÿßÿ±ÿ©', en:'Defeat' },
      'game.feedback.correct': { ar:'ÿ£ÿ≠ÿ≥ŸÜÿ™! ÿ≠ÿ±ŸÅ ÿµÿ≠Ÿäÿ≠ ŸäŸÇÿ™ÿ±ÿ® ÿ®ŸÉ ŸÖŸÜ ÿßŸÑÿ≠ŸÉŸÖÿ©.', en:'Great job! A correct letter brings you closer to the wisdom.' },
      'game.feedback.wrong'  : { ar:'Ÿáÿ∞Ÿá ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÑŸÖ ÿ™ÿµÿ® ÿßŸÑŸáÿØŸÅÿå ÿ¨ÿ±Ÿëÿ® ŸÖÿ≥ÿßÿ±Ÿãÿß ÿ¢ÿÆÿ±.', en:'That guess missed the mark‚Äîtry another path.' },
      'game.feedback.win'    : { ar:'ÿ•ÿ®ÿØÿßÿπ! ÿßŸÉÿ™ŸÖŸÑÿ™ ÿßŸÑÿ≠ŸÉŸÖÿ© ÿ®ÿßŸÑŸÉÿßŸÖŸÑ.', en:'Brilliant! The proverb has been unveiled.' },
      'game.feedback.lose'   : { ar:'ÿßŸÜÿ™Ÿáÿ™ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™ÿå ŸÑŸÉŸÜ ÿßŸÑÿ≠ŸÉŸÖÿ© ŸÖÿß ÿ≤ÿßŸÑÿ™ ÿ®ÿßŸÜÿ™ÿ∏ÿßÿ±ŸÉ.', en:'The tries are over, yet the wisdom still awaits you.' },
      'logic.title': { ar:'ÿ™ÿ≠ÿØŸä ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿ≥ÿ™ŸÇÿ±ÿßÿ¶Ÿä', en:'Pattern Logic Trainer' },
      'logic.subtitle': { ar:'ÿßÿ≥ÿ™ŸÉÿ¥ŸÅ ÿßŸÑŸÖÿ™ÿ™ÿßŸÑŸäÿßÿ™ ÿßŸÑÿ∞ŸÉŸäÿ© ŸàÿµŸÇŸÑ ŸÖŸáÿßÿ±ÿ© ÿßŸÉÿ™ÿ¥ÿßŸÅ ÿßŸÑŸÜŸÖÿ∑.', en:'Explore clever sequences and sharpen your pattern recognition.' },
      'logic.start': { ar:'ÿßÿ®ÿØÿ£ ÿßŸÑÿ™ÿ≠ÿØŸä', en:'Start Challenge' },
      'logic.newChallenge': { ar:'ÿ™ÿ≠ÿØŸç ÿ¨ÿØŸäÿØ', en:'New Challenge' },
      'logic.sequenceIntro': { ar:'ÿ£ŸÉŸÖŸÑ ÿßŸÑŸÖÿ™ÿ™ÿßŸÑŸäÿ© ÿßŸÑÿ™ÿßŸÑŸäÿ©:', en:'Complete the following sequence:' },
      'logic.optionsPrompt': { ar:'ÿßÿÆÿ™ÿ± ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ©', en:'Pick the correct answer' },
      'logic.feedback.correct': { ar:'ÿ•ÿ¨ÿßÿ®ÿ© ŸÖŸàŸÅŸÇÿ©! ŸÖŸÜÿ∑ŸÇŸÉ ÿ≠ÿßÿ∂ÿ±.', en:'Great choice! Your reasoning is sharp.' },
      'logic.feedback.wrong': { ar:'ŸÑŸäÿ≥ÿ™ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ©ÿå ÿ¨ÿ±Ÿëÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.', en:'That is not the right answer‚Äîtry again.' },
      'logic.explanation': { ar:'ÿßŸÑÿ¥ÿ±ÿ≠', en:'Explanation' },
      'logic.sequence.step': { ar:'ÿ™ÿ≤ÿØÿßÿØ ÿßŸÑŸÇŸäŸÖ ÿ®ŸÖŸÇÿØÿßÿ± {step} ŸÅŸä ŸÉŸÑ ÿÆÿ∑Ÿàÿ©.', en:'Values increase by {step} each step.' },
      'logic.square.hint': { ar:'ÿßŸÑÿ£ÿπÿØÿßÿØ ÿ™ŸÖÿ´ŸÑ ŸÖÿ±ÿ®ÿπÿßÿ™ ŸÖÿ™ÿ™ÿßŸÑŸäÿ© ÿ™ÿ®ÿØÿ£ ŸÖŸÜ {start}¬≤.', en:'The terms are consecutive squares starting from {start}¬≤.' },
      'logic.double.hint': { ar:'ŸÉŸÑ ŸÇŸäŸÖÿ© ÿ™ÿ≥ÿßŸàŸä ÿ∂ÿπŸÅ ÿßŸÑÿ≥ÿßÿ®ŸÇÿ©.', en:'Each value doubles the previous one.' },
      'game.lastMove'        : { ar:'ÿ±ÿØÿ© ŸÅÿπŸÑ ŸÅŸàÿ±Ÿäÿ©', en:'Instant Feedback' },
      'game.musicOn'         : { ar:'ÿßŸÑŸÖŸàÿ≥ŸäŸÇŸâ ŸÖŸÅÿπŸëŸÑÿ©', en:'Music On' },
      'game.musicOff'        : { ar:'ÿßŸÑŸÖŸàÿ≥ŸäŸÇŸâ ŸÖÿ™ŸàŸÇŸÅÿ©', en:'Music Off' },
      'game.timerOn'         : { ar:'ÿßŸÑŸÖÿ§ŸÇÿ™ ŸÜÿ¥ÿ∑', en:'Timer Enabled' },
      'game.timerOff'        : { ar:'ÿßŸÑŸÖÿ§ŸÇÿ™ ŸÖÿ™ŸàŸÇŸÅ', en:'Timer Disabled' },
      'game.overlay.winTitle'    : { ar:'ŸÖÿ®ÿ±ŸàŸÉ! ŸÑŸÇÿØ ŸÅÿ≤ÿ™ üéâ', en:'Bravo! You Won üéâ' },
      'game.overlay.winSubtitle' : { ar:'ÿ¨ŸáÿØŸÉ ÿ£ÿ´ŸÖÿ± ÿ≠ŸÉŸÖÿ© ŸÖÿ∂Ÿäÿ¶ÿ©.', en:'Your effort blossomed into shining wisdom.' },
      'game.overlay.loseTitle'   : { ar:'ÿßŸÜÿ™Ÿáÿ™ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿßÿ™', en:'Game Over' },
      'game.overlay.loseSubtitle': { ar:'ŸÑÿß ÿ™Ÿäÿ£ÿ≥ÿå ÿßŸÑÿ≠ŸÉŸÖÿ© ÿ™ŸèŸÉÿßŸÅÿ¶ ŸÖŸÜ ŸäÿπÿßŸàÿØ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ©.', en:'Do not despair‚Äîthe wisdom rewards another try.' },
      'game.rewardTitle'     : { ar:'ŸÖŸÉÿßŸÅÿ£ÿ© ÿßŸÑÿ≠ŸÉŸÖÿ©', en:'Wisdom Reward' },
      'game.tryAgain'        : { ar:'ÿ≠ÿßŸàŸÑ ŸÖÿ¨ÿØÿØŸãÿß', en:'Try Again' },
      'game.playAgain'       : { ar:'ÿßŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ', en:'Play Again' },
      'game.revealPrompt'    : { ar:'ÿßŸÜŸÇÿ± ŸÑÿßŸÉÿ™ÿ¥ÿßŸÅ ÿßŸÑÿ≠ŸÉŸÖÿ© ŸÉÿßŸÖŸÑÿ© ÿ®ÿπÿØ ŸÜŸáÿßŸäÿ© ÿßŸÑÿ¨ŸàŸÑÿ©.', en:'Tap to reveal the full wisdom after the round ends.' }
    };

    /* ===================== Markdown: ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑŸÖÿπÿ±ŸÅŸä ===================== */
    const readmeStore = M.readme || {};
    const DOCS = {
      base:{
        ar: (readmeStore.base && readmeStore.base.ar) || '',
        en: (readmeStore.base && readmeStore.base.en) || (readmeStore.base && readmeStore.base.ar) || ''
      },
      tec:{
        ar: (readmeStore.tec && readmeStore.tec.ar) || '',
        en: (readmeStore.tec && readmeStore.tec.en) || (readmeStore.tec && readmeStore.tec.ar) || ''
      }
    };

    /* ===================== Game Data: ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ© ===================== */
    const PROVERBS = [
      {
        t:"ÿ±ÿ¨ÿπ ÿ®ÿÆŸÅŸä ÿ≠ŸÜŸäŸÜ",
        hint:"ŸäŸèŸÇÿßŸÑ ŸÑŸÖŸÜ ÿπÿßÿØ ÿ®ŸÑÿß ŸÜÿ™Ÿäÿ¨ÿ©",
        explanation:"ÿ™ÿ≠ŸÉŸä ÿßŸÑŸÇÿµÿ© ÿπŸÜ ÿ±ÿ¨ŸÑ ŸÅÿ¥ŸÑ ŸÅŸä ŸÖŸÅÿßŸàÿ∂ÿ© ÿ•ÿ≥ŸÉÿßŸÅŸä ŸÅÿπÿßÿØ ÿÆÿßŸÑŸä ÿßŸÑŸàŸÅÿßÿ∂ ŸàŸÇÿØ ŸÅŸÇÿØ ŸÜÿπŸÑŸäŸáÿå ŸÅÿµÿßÿ± ŸÖÿ´ŸÑÿßŸã ÿπŸÜ ÿßŸÑÿÆŸäÿ®ÿ© ÿ®ÿπÿØ ŸÖÿ¥ŸÇÿ©.",
        lesson:"ÿßŸÑÿ™ÿÆÿ∑Ÿäÿ∑ ŸàÿßŸÑŸÖÿ±ŸàŸÜÿ© ŸÅŸä ÿßŸÑÿ™ŸÅÿßŸàÿ∂ Ÿäÿ≠ŸÖŸäÿßŸÜ ŸÖŸÜ ÿ∂Ÿäÿßÿπ ÿßŸÑÿ¨ŸáÿØ ÿ®ŸÑÿß ÿ´ŸÖÿ±.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ŸÇÿØŸäŸÖ"
      },
      {
        t:"ÿßŸÑŸä ÿßÿÆÿ™ÿ¥Ÿàÿß ŸÖÿßÿ™Ÿàÿß",
        hint:"ŸäŸèŸÜÿ™ŸÇÿØ ŸÅŸäŸá ÿ∞Ÿáÿßÿ® ÿßŸÑÿ≠Ÿäÿßÿ°",
        explanation:"ŸÜÿ¥ÿ£ ŸÅŸä ŸÖÿµÿ± ÿ≤ŸÖŸÜ ÿßŸÑÿ≠ÿ±ŸäŸÇ ÿ≠ŸäŸÜ ŸÅÿ∂ŸÑÿ™ ÿ®ÿπÿ∂ ÿßŸÑŸÜÿ≥ÿßÿ° ÿßŸÑŸÖÿ≠ÿßŸÅÿ∏ÿ© ÿπŸÑŸâ ÿ≠Ÿäÿßÿ¶ŸáŸÜ ŸÅŸÖŸèÿ™ŸÜÿå ŸÅÿµÿßÿ± ŸÉŸÜÿßŸäÿ© ÿπŸÜ ÿ™ÿ®ÿØŸÑ ÿßŸÑÿ£ÿ≠ŸàÿßŸÑ Ÿàÿ∫Ÿäÿßÿ® ÿßŸÑÿÆÿ¨ŸÑ.",
        lesson:"ÿ≠Ÿäÿßÿ° ÿßŸÑŸÖÿ¨ÿ™ŸÖÿπ ŸäŸÜÿπŸÉÿ≥ ÿπŸÑŸâ ÿ≥ŸÑŸàŸÉŸá Ÿàÿßÿ≥ÿ™ŸÇÿ±ÿßÿ±Ÿá.",
        source:"ŸÖÿ´ŸÑ ŸÖÿµÿ±Ÿä ÿ¥ÿπÿ®Ÿä"
      },
      {
        t:"ÿßŸÇŸÑÿ® ÿßŸÑŸÇÿØÿ±ÿ© ÿπŸÑŸâ ŸÅŸÖŸáÿß ÿ™ÿ∑ŸÑÿπ ÿßŸÑÿ®ŸÜÿ™ ŸÑÿßŸÖŸáÿß",
        hint:"Ÿäÿ¥Ÿäÿ± ŸÑŸÑÿ¥ÿ®Ÿá ÿ®ŸäŸÜ ÿßŸÑÿ£ÿ¨ŸäÿßŸÑ",
        explanation:"Ÿäÿπÿ®ÿ± ÿßŸÑŸÖÿ´ŸÑ ÿπŸÜ ÿ£ŸÜ ÿßŸÑŸÅÿ™ÿßÿ© ÿ∫ÿßŸÑÿ®Ÿãÿß ŸÖÿß ÿ™ÿ¥ÿ®Ÿá ÿ£ŸÖŸáÿß ŸÅŸä ÿßŸÑÿ∑ÿ®ÿßÿπ ŸàÿßŸÑÿ≥ŸÑŸàŸÉ ŸÖŸáŸÖÿß ÿ≠ÿßŸàŸÑÿ™ ÿßŸÑÿßÿÆÿ™ŸÑÿßŸÅ.",
        lesson:"ÿßŸÑŸÇÿØŸàÿ© ÿßŸÑÿ£ÿ≥ÿ±Ÿäÿ© ÿ™ÿ™ÿ±ŸÉ ÿ®ÿµŸÖÿ™Ÿáÿß ÿßŸÑÿπŸÖŸäŸÇÿ© ÿπŸÑŸâ ÿßŸÑÿ£ÿ®ŸÜÿßÿ°.",
        source:"ÿ™ÿ±ÿßÿ´ ÿ¥ÿπÿ®Ÿä ŸÖÿµÿ±Ÿä"
      },
      {
        t:"ÿßÿ®ŸÜŸÉ ÿπŸÑŸâ ŸÖÿß ÿ™ÿ±ÿ®ŸäŸá Ÿà ÿ¨Ÿàÿ≤ŸÉ ÿπŸÑŸâ ŸÖÿß ÿ™ÿπŸàÿØŸäŸá",
        hint:"ŸÅŸäŸá ÿ≠ÿØŸäÿ´ ÿπŸÜ ÿ£ÿ´ÿ± ÿßŸÑÿ™ÿ±ÿ®Ÿäÿ©",
        explanation:"ŸäŸàÿ∂ÿ≠ ÿßŸÑŸÖÿ´ŸÑ ÿ£ŸÜ ÿßŸÑÿ≥ŸÑŸàŸÉ ÿßŸÑÿ∞Ÿä ŸÜÿ≤ÿ±ÿπŸá ŸÅŸä ÿßŸÑÿ£ÿ®ŸÜÿßÿ° ŸàÿßŸÑÿ£ÿ≤Ÿàÿßÿ¨ ŸäŸÜÿπŸÉÿ≥ ÿπŸÑŸäŸÜÿß ŸÅŸä ÿßŸÑŸÖÿπÿßŸÖŸÑÿ© ŸàÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨.",
        lesson:"ÿßŸÑÿ™ÿ±ÿ®Ÿäÿ© ÿßŸÑŸàÿßÿπŸäÿ© ŸàÿßŸÑÿπŸÑÿßŸÇÿ© ÿßŸÑÿ∑Ÿäÿ®ÿ© ÿ™ÿµŸÜÿπ ÿßÿ≥ÿ™ŸÇÿ±ÿßÿ± ÿßŸÑÿ£ÿ≥ÿ±ÿ©.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ŸÖÿ™ÿØÿßŸàŸÑ"
      },
      {
        t:"ŸÖÿß ÿ≠ŸÉ ÿ¨ŸÑÿØŸÉ ŸÖÿ´ŸÑ ÿ∏ŸÅÿ±ŸÉ",
        hint:"ÿØÿπŸàÿ© ŸÑŸÑÿßÿπÿ™ŸÖÿßÿØ ÿπŸÑŸâ ÿßŸÑÿ∞ÿßÿ™",
        explanation:"Ÿäÿ¥ÿ¨ÿπ ÿßŸÑŸÖÿ´ŸÑ ÿπŸÑŸâ ÿßŸÑŸÇŸäÿßŸÖ ÿ®ÿßŸÑÿπŸÖŸÑ ÿ®ŸÜŸÅÿ≥ŸÉ ŸÑÿ£ŸÜŸÉ ÿßŸÑÿ£ÿ≠ÿ±ÿµ ÿπŸÑŸâ ŸÖÿµŸÑÿ≠ÿ™ŸÉ ŸàÿßŸÑÿ£ŸÇÿØÿ± ÿπŸÑŸâ ÿ•ÿØÿ±ÿßŸÉ ÿ≠ÿßÿ¨ÿ™ŸÉ.",
        lesson:"ÿßŸÑŸÖÿ®ÿßÿØÿ±ÿ© ÿßŸÑÿ∞ÿßÿ™Ÿäÿ© ÿ™ŸèÿÆÿ™ÿµÿ± ÿ®Ÿáÿß ÿßŸÑÿ∑ÿ±ŸÇ Ÿàÿ™ÿ™ÿ≠ŸÇŸÇ ÿßŸÑŸÜÿ¨ÿßÿ≠ÿßÿ™.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ŸÅÿµŸäÿ≠"
      },
      {
        t:"ÿÆŸäÿ± ÿßŸÑŸÉŸÑÿßŸÖ ŸÖÿß ŸÇŸÑ ŸàÿØŸÑ",
        hint:"Ÿäÿ™ÿπŸÑŸÇ ÿ®ŸÅÿµÿßÿ≠ÿ© ÿßŸÑÿ™ÿπÿ®Ÿäÿ±",
        explanation:"Ÿäÿ≠Ÿèÿ´ ÿßŸÑŸÖÿ´ŸÑ ÿπŸÑŸâ ÿßÿÆÿ™Ÿäÿßÿ± ŸÉŸÑŸÖÿßÿ™ ŸÇŸÑŸäŸÑÿ© ŸÑŸÉŸÜŸáÿß ŸÖÿπÿ®ÿ±ÿ© ŸàŸàÿßÿ∂ÿ≠ÿ© ÿ®ÿØŸÑ ÿßŸÑÿ•ÿ∑ÿßŸÑÿ© ÿßŸÑŸÖŸÖŸÑÿ©.",
        lesson:"ÿßŸÑÿ•Ÿäÿ¨ÿßÿ≤ ÿßŸÑŸàÿßÿ∂ÿ≠ Ÿäÿ®ŸÜŸä ÿ™ŸàÿßÿµŸÑŸãÿß ÿ£ŸÇŸàŸâ Ÿàÿ£ŸÉÿ´ÿ± ÿ™ÿ£ÿ´Ÿäÿ±Ÿãÿß.",
        source:"ÿ≠ŸÉŸÖÿ© ÿπÿ±ÿ®Ÿäÿ© ŸÇÿØŸäŸÖÿ©"
      },
      {
        t:"ÿßŸÑÿÆÿ®ÿ± ÿßŸÑŸä ÿßŸÜŸáÿ±ÿØŸá ÿ®ŸÅŸÑŸàÿ≥ ÿ®ŸÉÿ±ÿ© Ÿäÿ®ŸÇŸâ ÿ®ÿ®ŸÑÿßÿ¥",
        hint:"Ÿäÿ™ŸÜÿßŸàŸÑ ÿ≥ÿ±ÿπÿ© ÿßŸÜÿ™ÿ¥ÿßÿ± ÿßŸÑÿ£ÿÆÿ®ÿßÿ±",
        explanation:"ŸäŸèŸÇÿßŸÑ ÿπŸÜ ÿ£ÿ≥ÿ±ÿßÿ± ÿßŸÑŸäŸàŸÖ ÿßŸÑÿ™Ÿä ÿ≥ÿ±ÿπÿßŸÜ ŸÖÿß Ÿäÿπÿ±ŸÅŸáÿß ÿßŸÑÿ¨ŸÖŸäÿπÿå ŸÅŸÑÿß ÿ¨ÿØŸàŸâ ŸÖŸÜ ÿ¥ÿ±ÿßÿ° ŸÖÿß ÿ≥Ÿäÿ¥Ÿäÿπ ÿ®ŸÑÿß ÿ´ŸÖŸÜ.",
        lesson:"ÿßŸÑÿ≠ÿ∞ÿ± ŸÖŸÜ ÿßŸÑÿ™ÿ≥ÿ±Ÿäÿ® Ÿàÿ™ŸÇÿØŸäÿ± ŸÇŸäŸÖÿ© ÿßŸÑŸÖÿπŸÑŸàŸÖÿ© ŸÅŸä ŸàŸÇÿ™Ÿáÿß.",
        source:"ŸÖÿ´ŸÑ ÿ¥ÿπÿ®Ÿä ŸÖÿµÿ±Ÿä"
      },
      {
        t:"ŸÖŸÜ ÿ∑ŸÑÿ® ÿßŸÑÿπŸÑÿß ÿ≥Ÿáÿ± ÿßŸÑŸÑŸäÿßŸÑŸä",
        hint:"Ÿäÿ™ÿ≠ÿØÿ´ ÿπŸÜ ÿßŸÑÿßÿ¨ÿ™ŸáÿßÿØ",
        explanation:"ŸäÿØÿπŸà ÿßŸÑŸÖÿ´ŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÖÿ´ÿßÿ®ÿ±ÿ© Ÿàÿ®ÿ∞ŸÑ ÿßŸÑÿ¨ŸáÿØ ÿßŸÑÿ∑ŸàŸäŸÑ ŸÑÿ™ÿ≠ŸÇŸäŸÇ ÿßŸÑÿ£ŸáÿØÿßŸÅ ÿßŸÑÿ≥ÿßŸÖŸäÿ©.",
        lesson:"ÿßŸÑÿ∑ŸÖŸàÿ≠ Ÿäÿ™ÿ≠ŸÇŸÇ ÿ®ÿßŸÑÿπŸÖŸÑ ŸàÿßŸÑÿµÿ®ÿ± ŸÑÿß ÿ®ÿßŸÑÿ™ŸÖŸÜŸä.",
        source:"ÿ≠ŸÉŸÖÿ© ÿ™ÿπŸÑŸäŸÖŸäÿ©"
      },
      {
        t:"ÿßŸÑŸä ÿ®Ÿäÿ¥ŸäŸÑ ŸÇÿ±ÿ®ÿ© ŸÖÿÆÿ±ŸàŸÖÿ© ÿ®ÿ™ÿÆÿ± ÿπŸÑŸâ ÿ±ÿßÿ≥Ÿá",
        hint:"ÿ™ÿ≠ÿ∞Ÿäÿ± ŸÖŸÜ ÿßŸÑÿ•ŸáŸÖÿßŸÑ",
        explanation:"Ÿäÿ∂ÿ±ÿ® ŸÑŸÖŸÜ Ÿäÿ™ŸáÿßŸàŸÜ ŸÅŸä ÿ•ÿµŸÑÿßÿ≠ ÿßŸÑÿÆŸÑŸÑ ŸÅŸäÿπŸàÿØ ÿπŸÑŸäŸá ÿ®ÿßŸÑÿÆÿ≥ÿßÿ±ÿ© ŸàÿßŸÑŸÖÿ¥ŸÇÿ©.",
        lesson:"ÿπŸÑÿßÿ¨ ÿßŸÑŸÖÿ¥ŸÉŸÑÿ© ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ŸÖÿ®ŸÉÿ±Ÿãÿß ŸäŸÖŸÜÿπ ŸÉŸàÿßÿ±ÿ´ ÿ£ŸÉÿ®ÿ± ŸÑÿßÿ≠ŸÇŸãÿß.",
        source:"ŸÖÿ´ŸÑ ÿ¥ÿπÿ®Ÿä ÿ¥ÿßŸÖŸÑŸä"
      },
      {
        t:"ÿßÿØŸä ÿßŸÑÿπŸäÿ¥ ŸÑÿÆÿ®ÿßÿ≤Ÿá ŸàŸÑŸà ŸÉŸÑ ŸÜÿµŸá",
        hint:"Ÿäÿ¥Ÿäÿ± ÿ•ŸÑŸâ ÿßŸÑÿ™ÿÆÿµÿµ",
        explanation:"ŸäŸàÿµŸä ÿßŸÑŸÖÿ´ŸÑ ÿ®ÿ•ÿ≥ŸÜÿßÿØ ÿßŸÑÿ£ŸÖŸàÿ± ŸÑÿ£ŸáŸÑ ÿßŸÑÿÆÿ®ÿ±ÿ© ÿ≠ÿ™Ÿâ ŸÑŸà ŸÉŸÑŸÅ ÿßŸÑÿ£ŸÖÿ±ÿõ ŸÅÿßŸÑŸÜÿ™Ÿäÿ¨ÿ© ÿ≥ÿ™ŸÉŸàŸÜ ÿ£ÿ∂ŸÖŸÜ Ÿàÿ£ÿ¨ŸàÿØ.",
        lesson:"ÿßŸÑÿ´ŸÇÿ© ÿ®ÿßŸÑŸÖÿ™ÿÆÿµÿµŸäŸÜ ÿ™ÿ∂ŸÖŸÜ ÿ¨ŸàÿØÿ© ÿßŸÑŸÖÿÆÿ±ÿ¨ÿßÿ™ Ÿàÿ™ÿÆÿ™ÿµÿ± ÿßŸÑŸàŸÇÿ™.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ÿØÿßÿ±ÿ¨"
      },
      {
        t:"ŸÑÿß ÿ™ÿ§ÿ¨ŸÑ ÿπŸÖŸÑ ÿßŸÑŸäŸàŸÖ ÿ•ŸÑŸâ ÿßŸÑÿ∫ÿØ",
        hint:"ŸÖÿ≠ÿßÿ±ÿ®ÿ© ÿßŸÑÿ™ÿ≥ŸàŸäŸÅ",
        explanation:"ŸäŸÜÿ®Ÿá ÿßŸÑŸÖÿ´ŸÑ ÿ•ŸÑŸâ ÿÆÿ∑Ÿàÿ±ÿ© ÿ™ÿ£ÿ¨ŸäŸÑ ÿßŸÑÿ£ÿπŸÖÿßŸÑ ŸÑÿ£ŸÜ ÿ™ÿ±ÿßŸÉŸÖŸáÿß Ÿäÿ≥ÿ®ÿ® ÿ∂Ÿäÿßÿπ ÿßŸÑŸÅÿ±ÿµ ŸàÿßŸÑÿßÿ∂ÿ∑ÿ±ÿßÿ®.",
        lesson:"ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ ÿßŸÑŸÅŸàÿ±Ÿä ŸäŸÅÿ™ÿ≠ ÿ£ÿ®Ÿàÿßÿ® ÿßŸÑŸÜÿ¨ÿßÿ≠ ŸàŸäŸÇŸÑŸÑ ÿßŸÑÿ™Ÿàÿ™ÿ±.",
        source:"ÿ≠ŸÉŸÖÿ© ÿ•ÿØÿßÿ±Ÿäÿ© ÿπÿßŸÑŸÖŸäÿ©"
      },
      {
        t:"ÿßŸÑŸàŸÇÿ™ ŸÉÿßŸÑÿ≥ŸäŸÅ ÿßŸÜ ŸÑŸÖ ÿ™ŸÇÿ∑ÿπŸá ŸÇÿ∑ÿπŸÉ",
        hint:"Ÿäÿ§ŸÉÿØ ÿπŸÑŸâ ŸÇŸäŸÖÿ© ÿßŸÑÿ≤ŸÖŸÜ",
        explanation:"Ÿäÿ¥ÿ®Ÿá ÿßŸÑŸÖÿ´ŸÑ ÿßŸÑŸàŸÇÿ™ ÿ®ÿßŸÑÿ≥ŸäŸÅ ÿßŸÑÿ≠ÿßÿØ ÿßŸÑÿ∞Ÿä ÿ•ŸÜ ŸÑŸÖ ŸÜÿ≠ÿ≥ŸÜ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖŸá ÿ≥ŸäŸàŸÇÿπ ÿ®ŸÜÿß ÿßŸÑÿÆÿ≥ÿßÿ±ÿ©.",
        lesson:"ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸàŸÇÿ™ ŸÖÿ≠Ÿàÿ± ÿ£ÿ≥ÿßÿ≥Ÿä ŸÑŸÑÿ™ŸÅŸàŸÇ ŸÅŸä ÿßŸÑÿ≠Ÿäÿßÿ©.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ŸÖÿ£ÿ´Ÿàÿ±"
      },
      {
        t:"ÿßŸÑÿµÿ®ÿ± ŸÖŸÅÿ™ÿßÿ≠ ÿßŸÑŸÅÿ±ÿ¨",
        hint:"ŸäÿØÿπŸà ŸÑŸÑÿ™ÿ±Ÿäÿ´",
        explanation:"ŸäÿπŸÑŸÖŸÜÿß ÿßŸÑŸÖÿ´ŸÑ ÿ£ŸÜ ÿ∂ŸäŸÇ ÿßŸÑŸÑÿ≠ÿ∏ÿ© ŸÑÿß ŸäÿØŸàŸÖ Ÿàÿ£ŸÜ ÿßŸÑÿµÿ®ÿ± ŸäŸÅÿ™ÿ≠ ÿ£ÿ®Ÿàÿßÿ® ÿßŸÑÿ≠ŸÑŸàŸÑ ÿßŸÑŸÖÿ™ŸàŸÇÿπÿ© Ÿàÿ∫Ÿäÿ± ÿßŸÑŸÖÿ™ŸàŸÇÿπÿ©.",
        lesson:"ÿßŸÑŸáÿØŸàÿ° ŸàÿßŸÑÿ´ÿ®ÿßÿ™ ŸäŸÖŸÜÿ≠ÿßŸÜŸÜÿß ÿ±ÿ§Ÿäÿ© ÿ£Ÿàÿ∂ÿ≠ ŸÑŸÑŸÅÿ±ÿµ ÿßŸÑŸÖÿÆÿ™ÿ®ÿ¶ÿ©.",
        source:"ÿ≠ŸÉŸÖÿ© ÿπÿ±ÿ®Ÿäÿ© ÿ±Ÿàÿ≠ÿßŸÜŸäÿ©"
      },
      {
        t:"ŸÖŸÜ ÿ¨ÿØ Ÿàÿ¨ÿØ ŸàŸÖŸÜ ÿ≤ÿ±ÿπ ÿ≠ÿµÿØ",
        hint:"Ÿäÿ±ÿ™ÿ®ÿ∑ ÿ®ÿßŸÑÿπŸÖŸÑ ÿßŸÑÿ¨ÿßÿØ",
        explanation:"Ÿäÿ¨ŸÖÿπ ÿßŸÑŸÖÿ´ŸÑ ÿ®ŸäŸÜ ÿ®ÿ∞ŸÑ ÿßŸÑÿ¨ŸáÿØ ŸàŸÇÿ∑ŸÅ ÿßŸÑÿ´ŸÖÿßÿ± ŸÉÿπŸÑÿßŸÇÿ© ÿ≥ÿ®ÿ®Ÿäÿ© ŸÑÿß ŸÖŸÅÿ± ŸÖŸÜŸáÿß.",
        lesson:"ÿßŸÑÿßÿ¨ÿ™ŸáÿßÿØ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ± Ÿäÿ´ŸÖÿ± ŸÖŸáŸÖÿß ÿ∑ÿßŸÑ ÿßŸÑÿ≤ŸÖŸÜ.",
        source:"ŸÇŸàŸÑ ŸÖÿ£ÿ´Ÿàÿ± ŸÅŸä ÿßŸÑÿ™ÿ±ÿ®Ÿäÿ©"
      },
      {
        t:"ŸÅŸä ÿßŸÑÿ™ÿ£ŸÜŸä ÿßŸÑÿ≥ŸÑÿßŸÖÿ© ŸàŸÅŸä ÿßŸÑÿπÿ¨ŸÑÿ© ÿßŸÑŸÜÿØÿßŸÖÿ©",
        hint:"Ÿäÿ≠ÿ∞ÿ± ŸÖŸÜ ÿßŸÑÿ™ÿ≥ÿ±ÿπ",
        explanation:"Ÿäÿ∏Ÿáÿ± ÿßŸÑŸÖÿ´ŸÑ ÿ£ŸÜ ÿßŸÑÿ™ÿ£ŸÜŸä ŸäŸÖŸÜÿ≠ ÿßŸÑÿ≥ŸÑÿßŸÖÿ© ÿ®ŸäŸÜŸÖÿß ÿßŸÑÿπÿ¨ŸÑÿ© ÿ∫Ÿäÿ± ÿßŸÑŸÖÿ≠ÿ≥Ÿàÿ®ÿ© ÿ™ÿ¨ÿ± ÿßŸÑŸÜÿØŸÖ.",
        lesson:"ÿßŸÑÿ™ÿ±ŸàŸëŸä ŸÇÿ®ŸÑ ÿßŸÑŸÇÿ±ÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿµŸäÿ±Ÿäÿ© Ÿäÿ¨ŸÜŸëÿ® ÿßŸÑÿ£ÿÆÿ∑ÿßÿ° ÿßŸÑŸÉÿ®Ÿäÿ±ÿ©.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ŸÖÿ¥ÿ™ÿ±ŸÉ"
      },
      {
        t:"ÿ•ÿ∞ÿß ÿ™ŸÖ ÿßŸÑÿπŸÇŸÑ ŸÜŸÇÿµ ÿßŸÑŸÉŸÑÿßŸÖ",
        hint:"ŸäŸÖÿ¨ÿØ ÿßŸÑÿµŸÖÿ™ ÿßŸÑÿ≠ŸÉŸäŸÖ",
        explanation:"Ÿäÿ±Ÿâ ÿßŸÑŸÖÿ´ŸÑ ÿ£ŸÜ ÿßŸÉÿ™ŸÖÿßŸÑ ÿßŸÑÿ≠ŸÉŸÖÿ© Ÿäÿ¨ÿπŸÑ ÿµÿßÿ≠ÿ®Ÿáÿß ŸÇŸÑŸäŸÑ ÿßŸÑŸÉŸÑÿßŸÖ ŸÑÿ£ŸÜŸá Ÿäÿ≤ŸÜ ÿßŸÑÿπÿ®ÿßÿ±ÿßÿ™.",
        lesson:"ÿßŸÑŸàÿπŸä ÿ®ÿ∞ÿßÿ™ŸÉ Ÿäÿ¨ÿπŸÑŸÉ ÿ™ÿÆÿ™ÿßÿ± ŸÉŸÑŸÖÿßÿ™ŸÉ ÿ®ÿπŸÜÿßŸäÿ©.",
        source:"ÿ≠ŸÉŸÖÿ© ŸÖŸÜÿ≥Ÿàÿ®ÿ© ŸÑŸÑÿ•ŸÖÿßŸÖ ÿπŸÑŸä"
      },
      {
        t:"ÿ•ÿ∞ÿß ÿπÿ±ŸÅ ÿßŸÑÿ≥ÿ®ÿ® ÿ®ÿ∑ŸÑ ÿßŸÑÿπÿ¨ÿ®",
        hint:"ÿπŸÜ ŸÅŸáŸÖ ÿßŸÑÿÆŸÑŸÅŸäÿßÿ™",
        explanation:"Ÿäÿ§ŸÉÿØ ÿßŸÑŸÖÿ´ŸÑ ÿ£ŸÜ ŸÖÿπÿ±ŸÅÿ© ÿßŸÑÿ£ÿ≥ÿ®ÿßÿ® ÿ™ÿ≤ŸäŸÑ ÿßŸÑÿ∫ÿ±ÿßÿ®ÿ© Ÿàÿ™ŸÉÿ¥ŸÅ ŸÖŸÜÿ∑ŸÇ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´.",
        lesson:"ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑÿπŸÖŸäŸÇ ŸÑŸÑÿ£ÿ≠ÿØÿßÿ´ ŸäŸÖŸÜÿ≠ŸÜÿß ÿ≠ŸÑÿßŸã ÿ£ÿØŸÇ ŸàŸÇÿ±ÿßÿ±Ÿãÿß ÿ£ÿµŸàÿ®.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ŸÇÿØŸäŸÖ"
      },
      {
        t:"ÿØÿ±ŸáŸÖ ŸàŸÇÿßŸäÿ© ÿÆŸäÿ± ŸÖŸÜ ŸÇŸÜÿ∑ÿßÿ± ÿπŸÑÿßÿ¨",
        hint:"Ÿäÿ¥ÿ¨ÿπ ÿßŸÑŸàŸÇÿßŸäÿ©",
        explanation:"ŸäÿØÿπŸà ÿßŸÑŸÖÿ´ŸÑ ŸÑŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ŸÅŸä ÿßŸÑŸàŸÇÿßŸäÿ© ŸÖŸÜ ÿßŸÑÿÆÿ∑ÿ± ŸÇÿ®ŸÑ ŸàŸÇŸàÿπŸá ŸÑÿ£ŸÜ ÿßŸÑÿπŸÑÿßÿ¨ ŸÑÿßÿ≠ŸÇŸãÿß ŸÖŸÉŸÑŸÅ ŸàŸÖŸèÿ±ŸáŸÇ.",
        lesson:"ÿßŸÑÿßÿ≥ÿ™ÿ®ÿßŸÇ ŸàÿßŸÑÿ™ÿÆÿ∑Ÿäÿ∑ ŸäŸÇŸÑŸÑÿßŸÜ ÿßŸÑÿÆÿ≥ÿßÿ¶ÿ± ÿßŸÑŸÖÿßÿØŸäÿ© ŸàÿßŸÑŸÖÿπŸÜŸàŸäÿ©.",
        source:"ÿ≠ŸÉŸÖÿ© ÿ∑ÿ®Ÿäÿ© ÿ¥ÿßÿ¶ÿπÿ©"
      },
      {
        t:"ŸÑÿß ŸäŸÖŸàÿ™ ÿßŸÑÿ∞ÿ¶ÿ® ŸàŸÑÿß ÿ™ŸÅŸÜŸâ ÿßŸÑÿ∫ŸÜŸÖ",
        hint:"Ÿäÿ±ÿµÿØ ÿßŸÑÿ™ÿπÿßÿ±ÿ∂ ÿ®ŸäŸÜ ŸÖÿµŸÑÿ≠ÿ™ŸäŸÜ",
        explanation:"Ÿäÿ∂ÿ±ÿ® ŸÑŸÖŸÜ Ÿäÿ≠ÿßŸàŸÑ ÿßŸÑÿ¨ŸÖÿπ ÿ®ŸäŸÜ ŸÖÿ™ÿ∂ÿßÿØŸäŸÜ ÿØŸàŸÜ ÿ™ÿ∂ÿ≠Ÿäÿ©ÿå ŸàŸáŸà ÿ£ŸÖÿ± ŸÖÿ≥ÿ™ÿ≠ŸäŸÑ ÿ∫ÿßŸÑÿ®Ÿãÿß.",
        lesson:"ÿßŸÑŸÇÿ±ÿßÿ±ÿßÿ™ ÿßŸÑÿ¨ÿßÿØÿ© ÿ™ÿ≥ÿ™ŸÑÿ≤ŸÖ ÿßÿÆÿ™Ÿäÿßÿ±Ÿãÿß Ÿàÿßÿ∂ÿ≠Ÿãÿß Ÿàÿ™ÿ∂ÿ≠Ÿäÿ© ŸÖÿ≠ÿ≥Ÿàÿ®ÿ©.",
        source:"ŸÖÿ´ŸÑ ÿ®ÿØŸàŸä"
      },
      {
        t:"ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÉŸÑÿßŸÖ ŸÖŸÜ ŸÅÿ∂ÿ© ŸÅÿßŸÑÿ≥ŸÉŸàÿ™ ŸÖŸÜ ÿ∞Ÿáÿ®",
        hint:"ŸäŸÅÿßÿ∂ŸÑ ÿ®ŸäŸÜ ÿßŸÑŸÉŸÑÿßŸÖ ŸàÿßŸÑÿµŸÖÿ™",
        explanation:"Ÿäÿ¥ÿØÿØ ÿßŸÑŸÖÿ´ŸÑ ÿπŸÑŸâ ŸÇŸäŸÖÿ© ÿßŸÑÿµŸÖÿ™ ŸÅŸä ŸÖŸàÿßÿ∂ÿπ ÿßŸÑÿ≠ŸÉŸÖÿ© ŸÖŸÇÿßÿ±ŸÜÿ© ÿ®ÿßŸÑŸÉŸÑÿßŸÖ ÿßŸÑÿ≤ÿßÿ¶ÿØ.",
        lesson:"ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÑÿ≠ÿ∏ÿ© ÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿ© ŸÑŸÑŸÉŸÑÿßŸÖ ŸÖŸáÿßÿ±ÿ© ŸÇŸäÿßÿØŸäÿ© ŸÖŸáŸÖÿ©.",
        source:"ŸÇŸàŸÑ ŸÖÿ£ÿ´Ÿàÿ± ÿπÿ±ÿ®Ÿä"
      },
      {
        t:"ÿ±ÿ® ÿ∂ÿßÿ±ÿ© ŸÜÿßŸÅÿπÿ©",
        hint:"Ÿäÿ±Ÿâ ÿßŸÑÿÆŸäÿ± ŸÅŸä ÿßŸÑÿßÿ®ÿ™ŸÑÿßÿ°",
        explanation:"ŸäŸàÿ∂ÿ≠ ÿßŸÑŸÖÿ´ŸÑ ÿ£ŸÜ ÿßŸÑŸÖÿµÿßÿ¶ÿ® ŸÇÿØ ÿ™ÿ≠ŸÖŸÑ ŸÅŸä ÿ∑Ÿäÿßÿ™Ÿáÿß ŸÅÿ±ÿµŸãÿß Ÿàÿ£ŸÑÿ∑ÿßŸÅŸãÿß ŸÑÿß ŸÜÿ±ÿßŸáÿß ŸÑŸÑŸàŸáŸÑÿ© ÿßŸÑÿ£ŸàŸÑŸâ.",
        lesson:"ÿ™ÿ∫ŸäŸäÿ± ÿ≤ÿßŸàŸäÿ© ÿßŸÑŸÜÿ∏ÿ± Ÿäÿ≠ŸàŸëŸÑ ÿßŸÑŸÖÿ≠ŸÜ ÿ•ŸÑŸâ ŸÖŸÜÿ≠ Ÿàÿπÿ®ÿ±.",
        source:"ÿ≠ŸÉŸÖÿ© ÿ•ÿ≥ŸÑÿßŸÖŸäÿ© ÿ¥ÿßÿ¶ÿπÿ©"
      },
      {
        t:"ÿßŸÑÿπŸÑŸÖ ŸÜŸàÿ±",
        hint:"ŸäŸèÿ¥ŸäÿØ ÿ®ÿßŸÑŸÖÿπÿ±ŸÅÿ©",
        explanation:"Ÿäÿ¥ÿ®Ÿá ÿßŸÑŸÖÿ´ŸÑ ÿßŸÑÿπŸÑŸÖ ÿ®ÿßŸÑŸÜŸàÿ± ÿßŸÑÿ∞Ÿä Ÿäÿ®ÿØÿØ ÿßŸÑÿ∏ŸÑÿßŸÖ ŸàŸäŸáÿØŸä ÿßŸÑÿπŸÇŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑÿµŸàÿßÿ®.",
        lesson:"ÿßŸÑÿ™ÿπŸÑŸÖ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ± ŸäŸÅÿ™ÿ≠ ÿßŸÑÿ¢ŸÅÿßŸÇ ŸàŸäÿµŸàŸÜ ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ ŸÖŸÜ ÿßŸÑÿ¨ŸáŸÑ.",
        source:"ŸÇŸàŸÑ ÿ™ÿ±ÿ®ŸàŸä ŸÖÿ£ÿ´Ÿàÿ±"
      },
      {
        t:"ŸÑŸäÿ≥ ÿßŸÑŸÅÿ™Ÿâ ŸÖŸÜ ŸÇÿßŸÑ ŸÉÿßŸÜ ÿ£ÿ®Ÿä",
        hint:"Ÿäÿ≠ÿ´ ÿπŸÑŸâ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ ÿßŸÑÿ¥ÿÆÿµŸä",
        explanation:"Ÿäÿ±ŸÅÿ∂ ÿßŸÑŸÖÿ´ŸÑ ÿßŸÑÿßÿ™ŸÉÿßÿ° ÿπŸÑŸâ ÿ£ŸÖÿ¨ÿßÿØ ÿßŸÑÿ¢ÿ®ÿßÿ° ŸàŸäÿØÿπŸà ŸÑÿµŸÜÿßÿπÿ© ŸÖÿ¨ÿØ ÿ∞ÿßÿ™Ÿä.",
        lesson:"ŸáŸàŸäÿ© ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ ÿ™ÿ®ŸÜŸâ ÿ®ÿ¨ŸáÿØŸá ŸÑÿß ÿ®ŸÜÿ≥ÿ®Ÿá ŸÅÿ≠ÿ≥ÿ®.",
        source:"ÿ®Ÿäÿ™ ŸÖŸÜ ÿ¥ÿπÿ± ÿßŸÑŸÖÿ™ŸÜÿ®Ÿä"
      },
      {
        t:"ŸÖŸÜ ÿ¥ÿ® ÿπŸÑŸâ ÿ¥Ÿäÿ° ÿ¥ÿßÿ® ÿπŸÑŸäŸá",
        hint:"Ÿäÿ™ÿπŸÑŸÇ ÿ®ÿßŸÑÿπÿßÿØÿßÿ™",
        explanation:"Ÿäÿ§ŸÉÿØ ÿßŸÑŸÖÿ´ŸÑ ÿ£ŸÜ ŸÖÿß ŸäŸÜÿ¥ÿ£ ÿπŸÑŸäŸá ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ ŸÅŸä ÿµÿ∫ÿ±Ÿá Ÿäÿ≥ÿ™ŸÖÿ± ÿ∫ÿßŸÑÿ®Ÿãÿß ŸÖÿπŸá ÿ≠ÿ™Ÿâ ÿßŸÑŸÉÿ®ÿ±.",
        lesson:"ÿ™ÿ¥ŸÉŸäŸÑ ÿßŸÑÿπÿßÿØÿßÿ™ ÿßŸÑÿ•Ÿäÿ¨ÿßÿ®Ÿäÿ© ŸÖÿ®ŸÉÿ±Ÿãÿß ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ÿ∑ŸàŸäŸÑ ÿßŸÑÿ£ŸÖÿØ.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ÿØÿßÿ±ÿ¨"
      },
      {
        t:"ÿπŸÜÿØ ÿßŸÑÿßŸÖÿ™ÿ≠ÿßŸÜ ŸäŸÉÿ±ŸÖ ÿßŸÑŸÖÿ±ÿ° ÿ£Ÿà ŸäŸáÿßŸÜ",
        hint:"ÿπŸÜ ŸÑÿ≠ÿ∏ÿßÿ™ ÿßŸÑÿ≠ÿ≥ŸÖ",
        explanation:"Ÿäÿ¥Ÿäÿ± ÿßŸÑŸÖÿ´ŸÑ ÿ•ŸÑŸâ ÿ£ŸÜ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±ÿßÿ™ ÿ™ŸÉÿ¥ŸÅ ÿ≠ŸÇŸäŸÇÿ© ÿßŸÑÿßÿ≥ÿ™ÿπÿØÿßÿØ ŸàÿßŸÑÿ¨ÿØŸäÿ©.",
        lesson:"ÿßŸÑÿßÿ≥ÿ™ÿπÿØÿßÿØ ÿßŸÑŸÖÿ≥ÿ™ŸÖÿ± Ÿäÿ¨ÿπŸÑ ÿßŸÑŸÖŸàÿßŸÇŸÅ ÿßŸÑÿ≠ÿßÿ≥ŸÖÿ© ŸÅÿ±ÿµÿ© ŸÑŸÑÿ™ÿ£ŸÑŸÇ.",
        source:"ÿ≠ŸÉŸÖÿ© ÿ™ÿπŸÑŸäŸÖŸäÿ©"
      },
      {
        t:"ÿ•ÿ∞ÿß ÿ£ÿ±ÿØÿ™ ÿ£ŸÜ ÿ™ÿ∑ÿßÿπ ŸÅÿ£ŸÖÿ± ÿ®ŸÖÿß Ÿäÿ≥ÿ™ÿ∑ÿßÿπ",
        hint:"ŸäŸàÿßÿ≤ŸÜ ÿ®ŸäŸÜ ÿßŸÑÿ∑ŸÖŸàÿ≠ ŸàÿßŸÑŸÇÿØÿ±ÿ©",
        explanation:"ŸäÿπŸÑŸÖ ÿßŸÑŸÖÿ´ŸÑ ÿßŸÑŸÇÿßÿØÿ© ÿ£ŸÜ ÿßŸÑÿ™ŸÉŸÑŸäŸÅ ÿ®ŸÖÿß ŸÅŸàŸÇ ÿßŸÑÿ∑ÿßŸÇÿ© ŸäŸàŸÑÿØ ÿßŸÑÿπÿµŸäÿßŸÜÿå ÿ£ŸÖÿß ÿßŸÑŸàÿßŸÇÿπŸäÿ© ŸÅÿ™ÿ¨ŸÑÿ® ÿßŸÑÿ∑ÿßÿπÿ©.",
        lesson:"ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ≠ŸÉŸäŸÖÿ© ÿ™ÿ±ÿßÿπŸä ÿ∑ÿßŸÇÿ© ÿßŸÑŸÅÿ±ŸäŸÇ Ÿàÿ≠ÿØŸàÿØ ÿßŸÑŸÖŸàÿßÿ±ÿØ.",
        source:"ŸÇŸàŸÑ ŸÖŸÜÿ≥Ÿàÿ® ŸÑÿπŸÖÿ± ÿ®ŸÜ ÿßŸÑÿÆÿ∑ÿßÿ®"
      },
      {
        t:"ÿπŸÑŸâ ŸÇÿØÿ± ÿ£ŸáŸÑ ÿßŸÑÿπÿ≤ŸÖ ÿ™ÿ£ÿ™Ÿä ÿßŸÑÿπÿ≤ÿßÿ¶ŸÖ",
        hint:"ÿπŸÜ ŸÇŸàÿ© ÿßŸÑÿ•ÿ±ÿßÿØÿ©",
        explanation:"Ÿäÿ¥Ÿäÿ± ÿßŸÑÿ®Ÿäÿ™ ÿ•ŸÑŸâ ÿ£ŸÜ ÿßŸÑŸÇÿ±ÿßÿ±ÿßÿ™ ÿßŸÑŸÉÿ®Ÿäÿ±ÿ© ŸÑÿß ŸäŸÜŸáÿ∂ ÿ®Ÿáÿß ÿ•ŸÑÿß ÿ£ÿµÿ≠ÿßÿ® ÿßŸÑŸáŸÖŸÖ ÿßŸÑÿπÿßŸÑŸäÿ©.",
        lesson:"ÿ∑ŸÖŸàÿ≠ŸÉ Ÿäÿ≠ÿØÿØ ÿ≠ÿ¨ŸÖ ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ ÿßŸÑÿ∞Ÿä ŸäŸÖŸÉŸÜ ÿ£ŸÜ ÿ™ÿ≠ŸÇŸÇŸá.",
        source:"ŸÖŸÜ ŸÇÿµŸäÿØÿ© ÿßŸÑŸÖÿ™ŸÜÿ®Ÿä"
      },
      {
        t:"ÿßŸÑÿ∑ŸäŸàÿ± ÿπŸÑŸâ ÿ£ÿ¥ŸÉÿßŸÑŸáÿß ÿ™ŸÇÿπ",
        hint:"Ÿäÿ™ŸÜÿßŸàŸÑ ÿµÿ≠ÿ®ÿ© ÿßŸÑŸÖÿ™ÿ¥ÿßÿ®ŸáŸäŸÜ",
        explanation:"ŸäŸÇŸàŸÑ ÿßŸÑŸÖÿ´ŸÑ ÿ•ŸÜ ÿßŸÑÿ£ŸÅÿ±ÿßÿØ ŸäŸÖŸäŸÑŸàŸÜ ÿ•ŸÑŸâ ŸÖŸÜ Ÿäÿ¥ÿ®ŸáŸàŸÜŸáŸÖ ŸÅŸä ÿßŸÑÿ∑ÿ®ÿßÿπ ŸàÿßŸÑŸÇŸäŸÖ.",
        lesson:"ÿßÿÆÿ™ÿ± ŸÖÿ≠Ÿäÿ∑ŸÉ ÿ®ÿπŸÜÿßŸäÿ© ŸÑÿ£ŸÜŸá ŸäÿπŸÉÿ≥ŸÉ ŸàŸäÿ§ÿ´ÿ± ÿπŸÑŸäŸÉ.",
        source:"ŸÖÿ´ŸÑ ÿπÿßŸÑŸÖŸä ŸÖÿ™ÿ±ÿ¨ŸÖ"
      },
      {
        t:"ŸÖŸÜ ÿ≥ÿßÿ± ÿπŸÑŸâ ÿßŸÑÿØÿ±ÿ® ŸàÿµŸÑ",
        hint:"Ÿäÿ™ÿ≠ÿØÿ´ ÿπŸÜ ÿßŸÑŸÖÿ´ÿßÿ®ÿ±ÿ©",
        explanation:"Ÿäÿ¨ÿ≥ÿØ ÿßŸÑŸÖÿ´ŸÑ ŸÇŸäŸÖÿ© ÿßŸÑÿßÿ≥ÿ™ŸÖÿ±ÿßÿ± ŸÅŸä ÿßŸÑÿ∑ÿ±ŸäŸÇ ÿ±ÿ∫ŸÖ ÿ∑ŸàŸÑ ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿ≠ÿ™Ÿâ ŸÜÿ®ŸÑÿ∫ ÿßŸÑŸáÿØŸÅ.",
        lesson:"ÿßŸÑŸÖŸàÿßÿ∏ÿ®ÿ© ÿßŸÑŸäŸàŸÖŸäÿ© ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ™ÿµŸÜÿπ ÿ•ŸÜÿ¨ÿßÿ≤Ÿãÿß ÿπÿ∏ŸäŸÖŸãÿß ŸÖÿπ ÿßŸÑÿ≤ŸÖŸÜ.",
        source:"ÿ≠ŸÉŸÖÿ© ÿ™ÿ∑ŸàŸäÿ± ÿ∞ÿßÿ™"
      },
      {
        t:"ÿ±ÿ≠ŸÖ ÿßŸÑŸÑŸá ÿßŸÖÿ±ÿ° ÿπÿ±ŸÅ ŸÇÿØÿ± ŸÜŸÅÿ≥Ÿá",
        hint:"ÿ≠ŸàŸÑ ÿ™ŸÇÿØŸäÿ± ÿßŸÑÿ∞ÿßÿ™",
        explanation:"Ÿäÿ¥ÿ¨ÿπ ÿßŸÑŸÖÿ´ŸÑ ÿπŸÑŸâ ŸÖÿπÿ±ŸÅÿ© ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ ŸÑÿ∑ÿßŸÇÿ™Ÿá Ÿàÿ≠ÿØŸàÿØŸá ÿ≠ÿ™Ÿâ ŸÑÿß Ÿäÿ∏ŸÑŸÖ ŸÜŸÅÿ≥Ÿá ŸàŸÑÿß Ÿäÿ™ÿ¨ÿßŸàÿ≤ ŸÇÿØÿ±ÿ™Ÿá.",
        lesson:"ÿßŸÑŸàÿπŸä ÿ®ÿßŸÑÿ∞ÿßÿ™ Ÿäÿ≥ÿßÿπÿØ ÿπŸÑŸâ ÿßÿÆÿ™Ÿäÿßÿ± ŸÖÿß ŸäŸÜÿßÿ≥ÿ®ŸÉ ŸÖŸÜ ŸÅÿ±ÿµ ŸàŸÖÿ≥ÿ§ŸàŸÑŸäÿßÿ™.",
        source:"ŸÇŸàŸÑ ŸÖÿ£ÿ´Ÿàÿ± ÿπŸÜ ÿπŸÖÿ± ÿ®ŸÜ ÿπÿ®ÿØ ÿßŸÑÿπÿ≤Ÿäÿ≤"
      },
      {
        t:"ÿßŸÑŸÇŸÜÿßÿπÿ© ŸÉŸÜÿ≤ ŸÑÿß ŸäŸÅŸÜŸâ",
        hint:"ŸäÿØÿπŸà ŸÑŸÑÿ±ÿ∂ÿß",
        explanation:"Ÿäÿ®ŸäŸÜ ÿßŸÑŸÖÿ´ŸÑ ÿ£ŸÜ ÿßŸÑŸÇŸÜÿßÿπÿ© ÿ´ÿ±Ÿàÿ© ÿØÿßÿÆŸÑŸäÿ© ŸÑÿß ÿ™ŸÜÿ™ŸáŸäÿå ŸÑÿ£ŸÜŸáÿß ÿ™ŸÖŸÜÿ≠ ÿµÿßÿ≠ÿ®Ÿáÿß ÿ±ÿßÿ≠ÿ© ŸÜŸÅÿ≥Ÿäÿ© ŸÖÿ≥ÿ™ÿØÿßŸÖÿ©.",
        lesson:"ÿ™ŸÇÿØŸäÿ± ÿßŸÑŸÜÿπŸÖ ÿßŸÑÿ≠ÿßŸÑŸäÿ© Ÿäÿ¨ŸÑÿ® ÿßŸÑÿ≥ŸÉŸäŸÜÿ© ŸàŸäÿ≠ŸÅÿ≤ ÿßŸÑÿπŸÖŸÑ ÿßŸÑŸÖÿ™Ÿàÿßÿ≤ŸÜ.",
        source:"ŸÖÿ´ŸÑ ÿπÿ±ÿ®Ÿä ŸÖÿ™ÿØÿßŸàŸÑ"
      },
      {
        t:"ÿ•ŸÜ ŸÖÿπ ÿßŸÑÿπÿ≥ÿ± Ÿäÿ≥ÿ±ÿß",
        hint:"ŸÖÿ≥ÿ™ŸÖÿØ ŸÖŸÜ ÿßŸÑŸÇÿ±ÿ¢ŸÜ",
        explanation:"Ÿäÿ±ÿ≥ÿÆ ÿßŸÑŸÖÿ´ŸÑ ÿßŸÑŸÇÿ±ÿ¢ŸÜŸä ÿ≠ŸÇŸäŸÇÿ© ÿ£ŸÜ ÿßŸÑÿ∂ŸäŸÇ Ÿäÿ™ÿ®ÿπŸá ŸÅÿ±ÿ¨ ŸÖÿ≤ÿØŸàÿ¨ ŸÑŸÖŸÜ Ÿäÿµÿ®ÿ± ŸàŸäÿ£ŸÖŸÑ.",
        lesson:"ÿßŸÑÿ£ŸÖŸÑ ŸàÿßŸÑÿ´ŸÇÿ© ÿ®ÿßŸÑŸÑŸá Ÿäÿ´ÿ®ÿ™ÿßŸÜ ÿßŸÑŸÇŸÑÿ® ŸÅŸä ŸÖŸàÿßÿ¨Ÿáÿ© ÿßŸÑŸÖÿµÿßÿπÿ®.",
        source:"ÿßŸÑŸÇÿ±ÿ¢ŸÜ ÿßŸÑŸÉÿ±ŸäŸÖ ‚Äî ÿ≥Ÿàÿ±ÿ© ÿßŸÑÿ¥ÿ±ÿ≠"
      }
    ];
	
    const AR_ALPHA = ['ÿß','ÿ®','ÿ™','ÿ´','ÿ¨','ÿ≠','ÿÆ','ÿØ','ÿ∞','ÿ±','ÿ≤','ÿ≥','ÿ¥','ÿµ','ÿ∂','ÿ∑','ÿ∏','ÿπ','ÿ∫','ŸÅ','ŸÇ','ŸÉ','ŸÑ','ŸÖ','ŸÜ','Ÿà','Ÿá','ÿ©','ÿ°','Ÿä','Ÿâ'];
    const norm = (ch)=> String(ch).replace(/[ÿ£ÿ•ÿ¢]/g,'ÿß');

    const SOUND_EFFECTS = {
      correct: 'https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3',
      wrong: 'https://assets.mixkit.co/sfx/preview/mixkit-failure-arcade-alert-notification-240.mp3',
      win: 'https://assets.mixkit.co/sfx/preview/mixkit-small-crowd-cheer-and-applause-518.mp3',
      lose: 'https://assets.mixkit.co/sfx/preview/mixkit-game-over-dark-2068.mp3'
    };

    const THEME_STORAGE_KEY = 'mishkah:theme:prefs:v1';
    const THEME_BACKGROUND_PRESETS = [
      {
        id:'nebula',
        label:{ ar:'ÿ¥ŸÅŸÇ ÿ®ŸÜŸÅÿ≥ÿ¨Ÿä', en:'Violet Nebula' },
        light:{
          gradient: 'linear-gradient(160deg, #f8f9ff 0%, #e8ecff 100%)',
          overlay1: 'radial-gradient(circle at 20% 25%, rgba(79, 70, 229, 0.18), transparent 55%)',
          overlay2: 'radial-gradient(circle at 80% 70%, rgba(14, 165, 233, 0.18), transparent 50%)',
          accentRing: 'rgba(79, 70, 229, 0.18)'
        },
        dark:{
          gradient: 'linear-gradient(160deg, #0d1224 0%, #111c3d 100%)',
          overlay1: 'radial-gradient(circle at 80% 30%, rgba(168, 85, 247, 0.22), transparent 55%)',
          overlay2: 'radial-gradient(circle at 15% 80%, rgba(56, 189, 248, 0.18), transparent 55%)',
          accentRing: 'rgba(129, 140, 248, 0.35)'
        }
      },
      {
        id:'sunset',
        label:{ ar:'ÿ£ŸÅŸÇ ÿßŸÑÿ∫ÿ±Ÿàÿ®', en:'Desert Sunset' },
        light:{
          gradient: 'linear-gradient(155deg, #fff4e6 0%, #ffd5c2 100%)',
          overlay1: 'radial-gradient(circle at 20% 25%, rgba(249, 115, 22, 0.22), transparent 55%)',
          overlay2: 'radial-gradient(circle at 80% 70%, rgba(236, 72, 153, 0.2), transparent 55%)',
          accentRing: 'rgba(249, 115, 22, 0.28)'
        },
        dark:{
          gradient: 'linear-gradient(155deg, #2b122e 0%, #40285d 100%)',
          overlay1: 'radial-gradient(circle at 70% 20%, rgba(236, 72, 153, 0.3), transparent 60%)',
          overlay2: 'radial-gradient(circle at 25% 80%, rgba(249, 115, 22, 0.28), transparent 60%)',
          accentRing: 'rgba(236, 72, 153, 0.38)'
        }
      },
      {
        id:'forest',
        label:{ ar:'ÿ∂ÿ®ÿßÿ® ÿßŸÑÿ∫ÿßÿ®ÿ©', en:'Forest Mist' },
        light:{
          gradient: 'linear-gradient(150deg, #ecfdf5 0%, #d1fae5 100%)',
          overlay1: 'radial-gradient(circle at 30% 25%, rgba(16, 185, 129, 0.2), transparent 55%)',
          overlay2: 'radial-gradient(circle at 80% 70%, rgba(59, 130, 246, 0.15), transparent 55%)',
          accentRing: 'rgba(16, 185, 129, 0.28)'
        },
        dark:{
          gradient: 'linear-gradient(150deg, #052e16 0%, #0f4c3a 100%)',
          overlay1: 'radial-gradient(circle at 75% 25%, rgba(59, 130, 246, 0.22), transparent 60%)',
          overlay2: 'radial-gradient(circle at 20% 80%, rgba(16, 185, 129, 0.26), transparent 60%)',
          accentRing: 'rgba(16, 185, 129, 0.35)'
        }
      }
    ];

    const THEME_TEXT_SCHEMES = [
      {
        id:'cool',
        label:{ ar:'ÿ£ÿ≤ÿ±ŸÇ ŸÖÿ™ÿ≤ŸÜ', en:'Cool Focus' },
        light:{
          foreground: 'hsl(222 47% 16%)',
          muted: 'hsl(215 18% 42%)',
          primary: '#4f46e5',
          onPrimary: '#f9fafb'
        },
        dark:{
          foreground: 'hsl(210 40% 96%)',
          muted: 'hsl(215 20% 72%)',
          primary: '#6366f1',
          onPrimary: '#0f172a'
        }
      },
      {
        id:'warm',
        label:{ ar:'ÿØŸÅÿ° ÿßŸÑÿ¥ŸÖÿ≥', en:'Warm Glow' },
        light:{
          foreground: 'hsl(26 42% 24%)',
          muted: 'hsl(27 35% 48%)',
          primary: '#f97316',
          onPrimary: '#1f2937'
        },
        dark:{
          foreground: 'hsl(35 92% 92%)',
          muted: 'hsl(27 55% 70%)',
          primary: '#fb923c',
          onPrimary: '#111827'
        }
      },
      {
        id:'zen',
        label:{ ar:'ŸáÿØŸàÿ° ÿßŸÑÿ®ÿ≠ÿ±', en:'Zen Tide' },
        light:{
          foreground: 'hsl(200 45% 20%)',
          muted: 'hsl(198 34% 45%)',
          primary: '#0ea5e9',
          onPrimary: '#062029'
        },
        dark:{
          foreground: 'hsl(189 70% 92%)',
          muted: 'hsl(191 45% 70%)',
          primary: '#38bdf8',
          onPrimary: '#0f172a'
        }
      }
    ];

    const DESIGN_LAB_THEME_MODES = [
      { id:'light', icon:'üåû', labelKey:'designLab.mode.light' },
      { id:'dark', icon:'üåô', labelKey:'designLab.mode.dark' },
      { id:'pink', icon:'üå∏', labelKey:'designLab.mode.pink', preset:{ backgroundId:'sunset', textSchemeId:'warm' } }
    ];

    const DESIGN_VAR_DEFINITIONS = [
      { name:'--foreground', labelKey:'designLab.var.foreground', type:'color', default:'#1f2937' },
      { name:'--muted-foreground', labelKey:'designLab.var.muted', type:'color', default:'#64748b' },
      { name:'--primary', labelKey:'designLab.var.primary', type:'color', default:'#4f46e5' },
      { name:'--primary-foreground', labelKey:'designLab.var.primaryForeground', type:'color', default:'#f9fafb' },
      { name:'--accent-ring', labelKey:'designLab.var.accentRing', type:'color', default:'#6366f1' },
      { name:'--page-gradient', labelKey:'designLab.var.gradient', type:'text', default:'linear-gradient(160deg, #f8f9ff 0%, #e8ecff 100%)' },
      { name:'--page-overlay-1', labelKey:'designLab.var.overlay1', type:'text', default:'radial-gradient(circle at 20% 25%, rgba(79, 70, 229, 0.18), transparent 55%)' },
      { name:'--page-overlay-2', labelKey:'designLab.var.overlay2', type:'text', default:'radial-gradient(circle at 80% 70%, rgba(14, 165, 233, 0.18), transparent 50%)' },
      { name:'--panel-glass', labelKey:'designLab.var.panelGlass', type:'text', default:'rgba(255, 255, 255, 0.78)' },
      { name:'--panel-border', labelKey:'designLab.var.panelBorder', type:'text', default:'rgba(99, 102, 241, 0.12)' },
      { name:'--tile-bg', labelKey:'designLab.var.tileBg', type:'text', default:'linear-gradient(160deg, rgba(255, 255, 255, 0.95), rgba(241, 245, 249, 0.85))' },
      { name:'--tile-bg-revealed', labelKey:'designLab.var.tileRevealed', type:'text', default:'linear-gradient(160deg, rgba(129, 140, 248, 0.75), rgba(79, 70, 229, 0.65))' },
      { name:'--tile-border', labelKey:'designLab.var.tileBorder', type:'text', default:'rgba(99, 102, 241, 0.25)' },
      { name:'--letters-shadow', labelKey:'designLab.var.lettersShadow', type:'text', default:'0 18px 45px -24px rgba(15, 23, 42, 0.35)' },
      { name:'--letters-hover', labelKey:'designLab.var.lettersHover', type:'text', default:'0 25px 50px -20px rgba(99, 102, 241, 0.45)' },
      { name:'--tile-size', labelKey:'designLab.var.tileSize', type:'range', min:2.6, max:4, step:0.05, unit:'rem', default:'3.1rem' },
      { name:'--user-font-scale', labelKey:'designLab.var.fontScale', type:'range', min:90, max:130, step:2, unit:'%', default:'100', prefKey:'fontScale' }
    ];

    const DESIGN_VAR_DEF_MAP = Object.fromEntries(DESIGN_VAR_DEFINITIONS.map((def)=>[def.name, def]));
    const DESIGN_VAR_GROUPS = [
      { id:'core', labelKey:'designLab.group.core', hintKey:'designLab.group.coreHint', vars:['--foreground','--muted-foreground','--primary','--primary-foreground','--accent-ring'] },
      { id:'surface', labelKey:'designLab.group.surface', hintKey:'designLab.group.surfaceHint', vars:['--page-gradient','--page-overlay-1','--page-overlay-2','--panel-glass','--panel-border','--tile-bg','--tile-bg-revealed','--tile-border'] },
      { id:'effects', labelKey:'designLab.group.effects', hintKey:'designLab.group.effectsHint', vars:['--letters-shadow','--letters-hover'] },
      { id:'sizing', labelKey:'designLab.group.sizing', hintKey:'designLab.group.sizingHint', vars:['--tile-size','--user-font-scale'] }
    ];

    const THEME_BACKGROUND_MAP = Object.fromEntries(THEME_BACKGROUND_PRESETS.map((p)=>[p.id, p]));
    const THEME_TEXT_SCHEME_MAP = Object.fromEntries(THEME_TEXT_SCHEMES.map((p)=>[p.id, p]));
    const THEME_DEFAULT_PREFS = { backgroundId:'nebula', textSchemeId:'cool', fontScale:100, customVars:{} };

    let CURRENT_THEME_BASELINE = {};
    let LAST_APPLIED_CUSTOM_VARS = new Set();

    function normalizeThemePrefs(raw){
      const base = { ...THEME_DEFAULT_PREFS, customVars:{} };
      const src = raw && typeof raw==='object' ? raw : {};
      if (src.backgroundId && THEME_BACKGROUND_MAP[src.backgroundId]) base.backgroundId = src.backgroundId;
      if (src.textSchemeId && THEME_TEXT_SCHEME_MAP[src.textSchemeId]) base.textSchemeId = src.textSchemeId;
      const font = parseInt(src.fontScale, 10);
      if (!Number.isNaN(font)) base.fontScale = Math.min(120, Math.max(90, font));
      if (src.customVars && typeof src.customVars==='object'){
        const nextVars = {};
        Object.entries(src.customVars).forEach(([key,value])=>{
          const def = DESIGN_VAR_DEF_MAP[key];
          if (def && def.prefKey) return;
          if (typeof value==='string' && value.trim()!=='') nextVars[key] = value;
        });
        base.customVars = nextVars;
      }
      return base;
    }

    function loadThemePrefs(){
      if (typeof window==='undefined' || !window.localStorage) return { ...THEME_DEFAULT_PREFS };
      try {
        const raw = window.localStorage.getItem(THEME_STORAGE_KEY);
        if (!raw) return { ...THEME_DEFAULT_PREFS };
        return normalizeThemePrefs(JSON.parse(raw));
      } catch (_err){
        return { ...THEME_DEFAULT_PREFS };
      }
    }

    function persistThemePrefs(prefs){
      if (typeof window==='undefined' || !window.localStorage) return;
      try { window.localStorage.setItem(THEME_STORAGE_KEY, JSON.stringify(prefs)); }
      catch(_err){ /* ignore storage quota issues */ }
    }

    function applyThemePrefs(prefs){
      if (typeof document==='undefined') return;
      const root = document.documentElement;
      if (!root) return;
      LAST_APPLIED_CUSTOM_VARS.forEach((name)=>{ try { root.style.removeProperty(name); } catch(_err){} });
      LAST_APPLIED_CUSTOM_VARS = new Set();
      const mode = root.classList.contains('dark') ? 'dark' : 'light';
      const bgPreset = THEME_BACKGROUND_MAP[prefs.backgroundId] || THEME_BACKGROUND_MAP[THEME_DEFAULT_PREFS.backgroundId];
      const textPreset = THEME_TEXT_SCHEME_MAP[prefs.textSchemeId] || THEME_TEXT_SCHEME_MAP[THEME_DEFAULT_PREFS.textSchemeId];
      const bg = bgPreset[mode];
      const text = textPreset[mode];
      if (bg){
        root.style.setProperty('--page-gradient', bg.gradient);
        root.style.setProperty('--page-overlay-1', bg.overlay1);
        root.style.setProperty('--page-overlay-2', bg.overlay2);
        if (bg.accentRing) root.style.setProperty('--accent-ring', bg.accentRing);
      }
      if (text){
        root.style.setProperty('--foreground', text.foreground);
        root.style.setProperty('--muted-foreground', text.muted);
        root.style.setProperty('--primary', text.primary);
        root.style.setProperty('--ring', text.primary);
        root.style.setProperty('--primary-foreground', text.onPrimary);
      }
      root.style.setProperty('--user-font-scale', String(prefs.fontScale));
      if (typeof window!=='undefined' && window.getComputedStyle){
        const computed = window.getComputedStyle(root);
        const snapshot = {};
        DESIGN_VAR_DEFINITIONS.forEach((def)=>{
          snapshot[def.name] = computed.getPropertyValue(def.name).trim();
        });
        CURRENT_THEME_BASELINE = snapshot;
      }
      const customVars = prefs.customVars && typeof prefs.customVars==='object' ? prefs.customVars : {};
      Object.entries(customVars).forEach(([name,value])=>{
        const def = DESIGN_VAR_DEF_MAP[name];
        if (def && def.prefKey) return;
        if (typeof value==='string' && value.trim()!==''){
          root.style.setProperty(name, value);
          LAST_APPLIED_CUSTOM_VARS.add(name);
        }
      });
    }

    const INITIAL_THEME_PREFS = loadThemePrefs();
    applyThemePrefs(INITIAL_THEME_PREFS);

    function randInt(min, max){
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function shuffle(list){
      const arr = Array.isArray(list) ? list.slice() : [];
      for (let i = arr.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function generateLogicChallenge(){
      const types = ['arithmetic','square','double'];
      const type = types[Math.floor(Math.random()*types.length)];
      if (type==='square'){
        const start = randInt(2, 6);
        const sequence = [start, start+1, start+2, start+3].map((n)=> n*n);
        const answer = sequence[3];
        const pool = new Set([answer]);
        pool.add((start+4)*(start+4));
        pool.add((start+3)*(start+2));
        pool.add(Math.max(4, answer - (2*start + 3)));
        return {
          type,
          sequence,
          answer,
          options: shuffle(Array.from(pool).slice(0,4)),
          meta:{ start }
        };
      }
      if (type==='double'){
        const start = randInt(2, 9);
        const sequence = [start, start*2, start*4, start*8];
        const answer = sequence[3];
        const pool = new Set([answer]);
        pool.add(start*6);
        pool.add(start*10);
        pool.add(start*5);
        return {
          type,
          sequence,
          answer,
          options: shuffle(Array.from(pool).slice(0,4)),
          meta:{ start }
        };
      }
      const start = randInt(2, 18);
      const step = randInt(2, 7);
      const sequence = [start, start+step, start+2*step, start+3*step];
      const answer = sequence[3];
      const pool = new Set([answer]);
      while (pool.size < 4){
        const delta = randInt(-2,2);
        if (delta===0) continue;
        const candidate = answer + delta * step;
        if (candidate > 0) pool.add(candidate);
      }
      return {
        type:'arithmetic',
        sequence,
        answer,
        options: shuffle(Array.from(pool).slice(0,4)),
        meta:{ step, start }
      };
    }


    // ================================================================
    // ÿßŸÑÿ≤Ÿàÿ¨ ÿßŸÑÿ£ŸàŸÑ: ÿßŸÑÿ™ÿµŸÖŸäŸÖ ŸàÿßŸÑÿ™ÿ≥ŸàŸäÿ© (ÿ™ÿÆÿ∑Ÿäÿ∑ ÿßŸÑÿ¨ÿ≥ÿØ)
    // ŸáŸÜÿß ŸÜÿµŸÜÿπ ÿßŸÑŸáŸäŸÉŸÑ ŸàÿßŸÑÿ¥ŸÉŸÑ ÿßŸÑÿÆÿßÿ±ÿ¨Ÿä ŸÑŸÑÿ™ÿ∑ÿ®ŸäŸÇ.
    // ================================================================

    // ----------------------------------------------------------------
    // ÿßŸÑÿ±ŸÉŸÜ ÿßŸÑÿ£ŸàŸÑ: ÿßŸÑÿ∑ŸäŸÜ ŸàÿßŸÑÿ∞ÿ±ÿßÿ™ (`Atoms` as Components)
    // Ÿáÿ∞Ÿá ŸáŸä ÿßŸÑŸÖŸÉŸàŸÜÿßÿ™ÿå ŸÑÿ®ŸÜÿßÿ™ ÿßŸÑÿ®ŸÜÿßÿ° ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ÿßŸÑÿ™Ÿä ÿ™ÿ¥ŸÉŸÑ ÿ¨ÿ≥ÿØ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ.
    // ŸÉŸÑ ŸÖŸÉŸàŸÜ ŸáŸà "ÿ∞ÿ±ÿ©" ÿ£Ÿà ŸÖÿ¨ŸÖŸàÿπÿ© "ÿ∞ÿ±ÿßÿ™" ŸÑŸáÿß ÿ¥ŸÉŸÑ ŸàŸàÿ∏ŸäŸÅÿ© ŸÖÿ≠ÿØÿØÿ©.
    // ----------------------------------------------------------------
    
    function computeTimeLeft(g){
      if (!g || !g.timerOn) return null;
      if (g.status==='running') return Math.max(0, typeof g.timeLeft === 'number' ? g.timeLeft : g.timerSec);
      return g.status==='lost' ? 0 : g.timerSec;
    }

    function GameStatusStrip(db){
      if (db.data.activeTab !== 'game') return null;
      const { TL } = makeLangLookup(db);
      const g = db.data.game;
      if (!g) return null;
      const timeLeftValue = computeTimeLeft(g);
      const hearts = Array.from({ length:g.triesMax }, (_,i)=>
        D.Text.Span({ attrs:{ key:`strip-heart-${i}`, class: tw`${i < g.triesLeft ? '' : 'opacity-35'}` }}, [i < g.triesLeft ? '‚ù§Ô∏è' : 'üíî'])
      );
      const heartsRow = D.Containers.Div({ attrs:{ class: tw`flex items-center gap-1 text-lg sm:text-xl` }}, hearts);
      const timeStat = D.Containers.Div({ attrs:{ class: tw`flex items-center gap-2` }}, [
        D.Text.Span({ attrs:{ class: tw`text-sm sm:text-base text-[var(--muted-foreground)]` }}, ['‚è≥ ', TL('game.timeLabel')]),
        D.Text.Strong({ attrs:{ class: tw`text-base sm:text-lg` }}, [timeLeftValue !== null ? String(timeLeftValue) : '‚Äî']),
        timeLeftValue !== null
          ? D.Text.Span({ attrs:{ class: tw`text-xs sm:text-sm text-[var(--muted-foreground)]` }}, [TL('game.seconds')])
          : null
      ].filter(Boolean));
      const triesStat = D.Containers.Div({ attrs:{ class: tw`flex items-center gap-2` }}, [
        D.Text.Span({ attrs:{ class: tw`text-sm sm:text-base text-[var(--muted-foreground)]` }}, ['‚ù§Ô∏è ', TL('game.tries')]),
        D.Text.Strong({ attrs:{ class: tw`text-base sm:text-lg` }}, [String(g.triesLeft)]),
        D.Text.Span({ attrs:{ class: tw`text-xs sm:text-sm text-[var(--muted-foreground)]` }}, [`/ ${g.triesMax}`])
      ]);
      const statusStat = D.Containers.Div({ attrs:{ class: tw`flex items-center gap-2` }}, [
        D.Text.Span({ attrs:{ class: tw`text-sm sm:text-base text-[var(--muted-foreground)]` }}, ['üéØ ', TL('game.statusLabel')]),
        D.Text.Strong({ attrs:{ class: tw`text-base sm:text-lg` }}, [TL(`game.status.${g.status}`)])
      ]);
      const statsGroup = D.Containers.Div({ attrs:{ class: tw`flex flex-wrap items-center gap-4 text-sm sm:text-base font-semibold` }}, [timeStat, triesStat, statusStat]);
      const actionButtons = D.Containers.Div({ attrs:{ class: tw`flex flex-wrap items-center gap-2 sm:gap-3` }}, [
        heartsRow,
        UI.Button({ attrs:{ gkey:'ui:settings:open', class: tw`rounded-full px-4 font-semibold` }, variant:'ghost', size:'sm' }, [TL('game.settingsButton')]),
        UI.Button({ attrs:{ gkey:'game:start', class: tw`rounded-full px-6 py-2 font-semibold text-base` }, variant:'destructive', size:'md' }, [g.status==='running' ? TL('game.new') : TL('game.start')])
      ]);
      return D.Containers.Div({ attrs:{ class: `${tw`flex flex-wrap items-center justify-between gap-4 rounded-3xl px-5 py-3`} glass-panel glow-outline` }}, [
        statsGroup,
        actionButtons
      ]);
    }

    function HeaderBar(db){
      const { TL } = makeLangLookup(db);
      const designLabButton = UI.Button({ attrs:{ gkey:'design:lab:open', class: tw`rounded-full px-4 font-semibold` }, variant:'soft', size:'sm' }, ['üé® ', TL('designLab.openButton')]);
      const settingsButton = UI.Button({ attrs:{ gkey:'ui:settings:open', class: tw`rounded-full px-3 font-semibold` }, variant:'ghost', size:'sm' }, ['‚öôÔ∏è']);
      return D.Containers.Header({ attrs:{ class: tw`px-6 pt-5 pb-3` }}, [
        D.Containers.Div({ attrs:{ class: tw`mx-auto w-full max-w-[1600px]` }}, [
          D.Containers.Div({ attrs:{ class: `${tw`rounded-3xl px-5 py-5 space-y-4`} glass-panel glow-outline` }}, [
            D.Containers.Div({ attrs:{ class: tw`flex flex-wrap items-center justify-between gap-3` }}, [
              D.Containers.Div({ attrs:{ class: tw`flex flex-col gap-1` }}, [
                D.Text.Span({ attrs:{ class: tw`text-xl sm:text-2xl font-bold tracking-tight` }}, [TL('app.title')]),
                D.Text.Span({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('header.subtitle')])
              ]),
              D.Containers.Div({ attrs:{ class: tw`flex flex-wrap items-center gap-2 sm:gap-3` }}, [
                designLabButton,
                settingsButton,
                UI.Button({ attrs:{ gkey:'ui:lang-ar' }, variant:'ghost', size:'sm' }, ['AR']),
                UI.Button({ attrs:{ gkey:'ui:lang-en' }, variant:'ghost', size:'sm' }, ['EN']),
                UI.Button({ attrs:{ gkey:'ui:theme-toggle' }, variant:'soft', size:'sm' }, ['üåì'])
              ])
            ]),
            GameStatusStrip(db)
          ].filter(Boolean))
        ])
      ]);
    }

    function Sidebar(db){
      const { TL } = makeLangLookup(db);
      const route = db.data.activeTab;
      const NavBtn = (id,label,icon)=>{
        const active = route===id;
        return UI.Button({
          attrs:{
            gkey:`route:${id}`,
            class:`${tw`w-full justify-start text-start rounded-2xl transition-all duration-200`} glass-panel ${active ? 'glow-outline' : 'hover:opacity-90'} ${active?'':'opacity-85'}`
          },
          variant:'ghost', size:'sm'
        }, [`${icon} `, TL(label)]);
      };
      return D.Containers.Div({ attrs:{ class: tw`space-y-4` }}, [
        D.Containers.Div({ attrs:{ class: `${tw`rounded-3xl p-4 space-y-3`} glass-panel glow-outline` }}, [
          D.Text.Span({ attrs:{ class: tw`text-sm uppercase tracking-[0.3em] text-[var(--muted-foreground)]` }}, [TL('nav.menu')]),
          D.Containers.Nav({ attrs:{ class: tw`space-y-3` }}, [
            NavBtn('readmeBase','nav.readmeBase','üåå'),
            NavBtn('readmeTec','nav.readmeTec','üõ†Ô∏è'),
            NavBtn('counter','nav.counter','üî¢'),
            NavBtn('game','nav.game','üéÆ'),
            NavBtn('logic','nav.logic','üß†')
          ])
        ])
      ]);
    }

    function DocPanel(db, kind){
      const lang = db.env.lang || 'ar';
      const key = kind==='tec' ? 'doc.tec.lead' : 'doc.base.lead';
      const titleKey = kind==='tec' ? 'nav.readmeTec' : 'nav.readmeBase';
      const docs = db.data.docs || {};
      const store = kind==='tec' ? docs.tec || {} : docs.base || {};
      const fallback = lang==='ar' ? (store.en || '') : (store.ar || '');
      const content = store[lang] || fallback || '';
      const { TL } = makeLangLookup(db);

      return UI.Card({
        title: TL(titleKey),
        description: TL('doc.language.hint'),
        content: D.Containers.Div({ attrs:{ class: tw`space-y-4` }}, [
          D.Text.P({ attrs:{ class: tw`text-base font-semibold`, style:'color:color-mix(in oklab,var(--foreground) 92%, var(--primary) 8%);' }}, [TL(key)]),
          UI.Markdown({ content, className: tw`md-prose` })
        ])
      });
    }

    function CounterPanel(db){
      const { TL } = makeLangLookup(db);
      return UI.Card({
        title: TL('counter.title'),
        content: D.Containers.Div({ attrs:{ class: tw`flex items-center justify-center gap-3` }}, [
          UI.Button({ attrs:{ gkey:'counter:dec' }, variant:'soft', size:'sm' }, ['‚àí']),
          D.Text.Span({ attrs:{ class: tw`text-2xl font-bold` }}, [String(db.data.counter)]),
          UI.Button({ attrs:{ gkey:'counter:inc' }, variant:'soft', size:'sm' }, ['+']),
          UI.Button({ attrs:{ gkey:'counter:reset', class:tw`ms-4` }, variant:'ghost', size:'sm' }, [TL('counter.reset')]),
        ])
      });
    }

    function GamePanel(db){
      const { TL } = makeLangLookup(db);
      const g = db.data.game;
      const showSolution = g.revealSolution || g.status==='won';

      const pv = g.proverb?.t || '';
      const feedbackType = g.feedback?.type || 'idle';
      const feedbackStamp = g.feedback?.stamp || 0;

      const tiles = pv.split('').map((raw, idx)=>{
        if (raw===' ') return D.Containers.Div({ attrs:{ key:'sp'+idx, class: 'letter-space' }});
        const normalized = norm(raw);
        const revealed = !!g.guessed[normalized];
        return D.Containers.Div({
          attrs:{
            key:'bx'+idx,
            class: `${tw`grid place-items-center rounded-2xl text-2xl md:text-3xl font-semibold letter-tile letter-slot`}`,
            'data-revealed': revealed ? 'true' : 'false'
          }
        }, [ revealed ? raw : '' ]);
      });

      const puzzleRow = D.Containers.Div({ attrs:{ class: `${tw`flex flex-wrap justify-center gap-3`} puzzle-row` }}, tiles);

      const letters = D.Containers.Div({ attrs:{ class: `${tw`grid grid-cols-6 sm:grid-cols-8 xl:grid-cols-10 gap-2 letters-grid`}` }}, AR_ALPHA.map((L,i)=>
        UI.Button({
          attrs:{
            key:'L'+i,
            gkey:'game:guess',
            'data-ch':L,
            disabled: g.status!=='running' || !!g.guessed[L],
            class: tw`text-xl sm:text-2xl font-extrabold tracking-wider`
          },
          variant:'soft',
          size:'lg'
        }, [L])
      ));

      const feedbackClass = feedbackType && feedbackType!=='idle' ? ` feedback-${feedbackType}` : '';

      const boardCard = D.Containers.Div({ attrs:{ class: `${tw`space-y-6`} glass-panel glow-outline p-6 rounded-3xl game-board${feedbackClass}` }}, [
        D.Containers.Div({ attrs:{ class: tw`space-y-4` }}, [
          puzzleRow,
          UI.Divider(),
          D.Containers.Div({ attrs:{ class: tw`space-y-2` }}, [
            D.Text.Strong({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('game.letters')]),
            letters
          ])
        ])
      ]);

      const feedbackMessages = {
        correct: TL('game.feedback.correct'),
        wrong: TL('game.feedback.wrong'),
        win: TL('game.feedback.win'),
        lose: TL('game.feedback.lose')
      };
      const feedbackIcons = { correct:'‚úÖ', wrong:'‚ö†Ô∏è', win:'üèÜ', lose:'üíî' };

      const infoItems = [];
      if (feedbackType !== 'idle' && feedbackMessages[feedbackType]){
        infoItems.push(
          D.Containers.Div({ attrs:{ class: `${tw`rounded-3xl p-5 space-y-3`} glass-panel`, key:'feedback-card' }}, [
            UI.Badge({ attrs:{ class: tw`w-fit` }, leading: feedbackIcons[feedbackType] || '‚ú®', text:TL('game.lastMove') }),
            D.Text.P({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)] leading-relaxed` }}, [feedbackMessages[feedbackType]])
          ])
        );
      }

      if (g.proverb){
        infoItems.push(
          D.Containers.Div({ attrs:{ class: `${tw`rounded-3xl p-5 space-y-3`} glass-panel`, key:'hint-card' }}, [
            UI.Badge({ attrs:{ class: tw`w-fit` }, leading:'üí°', text:TL('game.hintTitle') }),
            D.Text.P({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)] leading-relaxed` }}, [g.proverb.hint])
          ])
        );
      }

      if (showSolution && g.proverb){
        infoItems.push(
          D.Containers.Div({ attrs:{ class: `${tw`rounded-3xl p-5 space-y-3`} glass-panel`, style:'grid-column: 1 / -1;', key:'solution-card' }}, [
            UI.Badge({ attrs:{ class: tw`w-fit` }, leading:'üìú', text:TL('game.solution') }),
            D.Text.P({ attrs:{ class: tw`text-lg font-semibold` }}, [g.proverb.t]),
            D.Text.P({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('game.explanation'), ': ', g.proverb.explanation]),
            D.Text.P({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('game.lesson'), ': ', g.proverb.lesson]),
            D.Text.P({ attrs:{ class: tw`text-xs text-[var(--muted-foreground)]` }}, [TL('game.source'), ': ', g.proverb.source])
          ])
        );
      }

      let infoSection = null;
      if (infoItems.length){
        let infoClass = tw`grid gap-4`;
        if (infoItems.length >= 3) infoClass += ' ' + tw`md:grid-cols-2 xl:grid-cols-3`;
        else if (infoItems.length === 2) infoClass += ' ' + tw`md:grid-cols-2`;
        infoSection = D.Containers.Div({ attrs:{ class: infoClass }}, infoItems);
      }

      const confettiLayer = feedbackType==='win'
        ? D.Containers.Div({ attrs:{ class:'confetti-layer', key:`confetti-${feedbackStamp}` }},
            Array.from({ length: 70 }, (_,i)=>{
              const colors = ['#f97316','#38bdf8','#a855f7','#facc15','#f472b6'];
              const left = (Math.random()*100).toFixed(2);
              const delay = (Math.random()*1.2).toFixed(2);
              return D.Text.Span({ attrs:{ key:`confetti-${i}`, class:'confetti-piece', style:`left:${left}%; background:${colors[i % colors.length]}; animation-delay:${delay}s;` }});
            })
          )
        : null;

      const resultCard = g.status==='won' && g.proverb
        ? D.Containers.Div({ attrs:{ class: `${tw`rounded-3xl p-6 space-y-4 text-center`} glass-panel celebration-card` }}, [
            D.Containers.Div({ attrs:{ class: `${tw`space-y-3`} game-overlay-content` }}, [
              UI.Badge({ attrs:{ class: tw`w-fit mx-auto` }, leading:'üéâ', text:TL('game.overlay.winTitle') }),
              D.Text.P({ attrs:{ class: tw`text-base text-[var(--muted-foreground)]` }}, [TL('game.overlay.winSubtitle')]),
              D.Text.P({ attrs:{ class: tw`text-lg font-semibold` }}, [g.proverb.t]),
              D.Text.P({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)] leading-relaxed` }}, [TL('game.rewardTitle'), ': ', g.proverb.lesson]),
              D.Text.P({ attrs:{ class: tw`text-xs text-[var(--muted-foreground)]` }}, [TL('game.source'), ': ', g.proverb.source]),
              UI.Button({ attrs:{ gkey:'game:start', class: tw`mt-2 px-8 py-3 rounded-full font-semibold` }, variant:'destructive', size:'lg' }, [TL('game.playAgain')])
            ])
          ])
        : g.status==='lost'
        ? UI.SweetNotice({
            attrs:{ key:'gameover-card', class: tw`gameover-card` },
            tone:'danger',
            icon:'üíî',
            title: TL('game.overlay.loseTitle'),
            message: TL('game.overlay.loseSubtitle'),
            hint: !showSolution ? TL('game.revealPrompt') : null,
            actions:[
              UI.Button({ attrs:{ gkey:'game:start', class: tw`px-7 py-3 rounded-full font-semibold` }, variant:'destructive', size:'lg' }, [TL('game.tryAgain')]),
              (!showSolution ? UI.Button({ attrs:{ gkey:'game:reveal', class: tw`px-7 py-3 rounded-full font-semibold` }, variant:'soft', size:'lg' }, [TL('game.reveal')]) : null)
            ].filter(Boolean)
          })
        : null;

      const playItems = [resultCard, boardCard].filter(Boolean);
      const playSection = playItems.length > 1
        ? D.Containers.Div({ attrs:{ class: tw`space-y-6` }}, playItems)
        : boardCard;

      const audioNode = (g.musicOn && g.status==='running')
        ? D.Media.Audio({ attrs:{ autoplay:true, loop:true, src:g.audioList[g.audioIdx].url, class: tw`hidden`, key:`bgm-${g.soundStamp||0}` }})
        : null;

      const cueAudio = (feedbackType && feedbackType!=='idle' && SOUND_EFFECTS[feedbackType])
        ? D.Media.Audio({ attrs:{ autoplay:true, src:SOUND_EFFECTS[feedbackType], class: tw`hidden`, key:`cue-${feedbackStamp}` }})
        : null;

      return D.Containers.Div({ attrs:{ class: `${tw`relative space-y-6`} game-panel` }}, [
        confettiLayer,
        playSection,
        infoSection,
        audioNode,
        cueAudio
      ].filter(Boolean));
    }

    function LogicGamePanel(db){
      const { TL } = makeLangLookup(db);
      const logic = db.data.logicGame || {};
      const challenge = logic.challenge;
      const hasChallenge = Array.isArray(challenge?.sequence);
      const bodySections = [];

      if (!hasChallenge){
        bodySections.push(
          D.Containers.Div({ attrs:{ class: tw`space-y-4 text-center py-8` }}, [
            D.Text.P({ attrs:{ class: tw`text-base text-[var(--muted-foreground)]` }}, [TL('logic.subtitle')]),
            UI.Button({ attrs:{ gkey:'logic:start', class: tw`rounded-full px-10 py-3 font-semibold` }, variant:'solid', size:'lg' }, [TL('logic.start')])
          ])
        );
      } else {
        bodySections.push(
          D.Containers.Div({ attrs:{ class: tw`flex justify-end` }}, [
            UI.Button({ attrs:{ gkey:'logic:start', class: tw`rounded-full px-6 font-semibold` }, variant:'soft', size:'sm' }, [TL('logic.newChallenge')])
          ])
        );
        const seqTiles = challenge.sequence.map((value, idx, arr)=>{
          const display = idx===arr.length-1 ? 'ÿü' : String(value);
          return D.Containers.Div({ attrs:{ key:`logic-seq-${idx}`, class: `${tw`w-16 h-16 md:w-20 md:h-20 rounded-3xl grid place-items-center text-lg md:text-xl font-semibold`} glass-panel` }}, [display]);
        });
        bodySections.push(
          D.Containers.Div({ attrs:{ class: tw`space-y-3` }}, [
            D.Text.Span({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('logic.sequenceIntro')]),
            D.Containers.Div({ attrs:{ class: tw`flex flex-wrap items-center justify-center gap-3` }}, seqTiles)
          ])
        );
        const optionsList = Array.isArray(logic.options) && logic.options.length ? logic.options : (challenge.options || []);
        const optionButtons = optionsList.map((value)=>{
          const choice = Number(value);
          const isSelected = logic.selected === choice;
          const feedbackType = logic.feedback?.type;
          const correctChoice = choice === challenge.answer;
          const isCorrectSelection = feedbackType==='correct' && isSelected && correctChoice;
          const isWrongSelection = feedbackType==='wrong' && isSelected && !correctChoice;
          let variant = 'soft';
          if (isCorrectSelection) variant = 'solid';
          else if (isWrongSelection) variant = 'destructive';
          const classParts = [];
          if (isSelected) classParts.push(tw`ring-2 ring-offset-2 ring-[var(--ring)]`);
          const btnAttrs = {
            key:`logic-opt-${choice}`,
            gkey:'logic:answer',
            'data-choice': String(choice),
            class: classParts.length ? classParts.join(' ') : undefined
          };
          if (feedbackType==='correct') btnAttrs.disabled = 'disabled';
          return UI.Button({ attrs: btnAttrs, variant, size:'md' }, [String(choice)]);
        });
        bodySections.push(
          D.Containers.Div({ attrs:{ class: tw`space-y-3` }}, [
            D.Text.Span({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('logic.optionsPrompt')]),
            D.Containers.Div({ attrs:{ class: tw`grid grid-cols-2 sm:grid-cols-4 gap-3` }}, optionButtons)
          ])
        );
        if (logic.feedback){
          let explanationText = '';
          if (challenge.type==='arithmetic'){ explanationText = TL('logic.sequence.step').replace('{step}', String(challenge.meta?.step ?? '')); }
          else if (challenge.type==='square'){ explanationText = TL('logic.square.hint').replace('{start}', String(challenge.meta?.start ?? '')); }
          else { explanationText = TL('logic.double.hint'); }
          const badgeIcon = logic.feedback.type==='correct' ? '‚úÖ' : 'üßê';
          bodySections.push(
            D.Containers.Div({ attrs:{ class: `${tw`rounded-3xl p-5 space-y-3`} glass-panel` }}, [
              UI.Badge({ attrs:{ class: tw`w-fit` }, leading: badgeIcon, text: TL(`logic.feedback.${logic.feedback.type}`) }),
              explanationText ? D.Text.P({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)] leading-relaxed` }}, [explanationText]) : null,
              D.Text.P({ attrs:{ class: tw`text-xs text-[var(--muted-foreground)]` }}, [TL('logic.explanation'), ': ', String(challenge.answer)])
            ].filter(Boolean))
          );
        }
      }

      return UI.Card({
        title: TL('logic.title'),
        description: TL('logic.subtitle'),
        content: D.Containers.Div({ attrs:{ class: tw`space-y-6` }}, bodySections)
      });
    }

    function DesignLabPanel(db){
      const design = db.data.designLab || {};
      if (!design.open) return null;
      const { TL } = makeLangLookup(db);
      const prefs = normalizeThemePrefs(db.data.themePrefs || INITIAL_THEME_PREFS);
      const customVars = prefs.customVars || {};
      const activeTheme = db.env.theme || 'light';

      const modeButtons = DESIGN_LAB_THEME_MODES.map((mode)=>{
        const isActive = mode.id==='pink'
          ? activeTheme==='pink'
          : (activeTheme===mode.id || (mode.id==='light' && activeTheme!=='dark' && activeTheme!=='pink'));
        const btnVariant = isActive ? 'soft' : 'ghost';
        const btnClass = isActive ? tw`shadow-[0_16px_36px_-22px_rgba(79,70,229,0.55)]` : '';
        return UI.Button({
          attrs:{
            key:`mode-${mode.id}`,
            gkey:'design:theme',
            'data-mode':mode.id,
            class: btnClass
          },
          variant: btnVariant,
          size:'sm'
        }, [`${mode.icon} `, TL(mode.labelKey)]);
      });

      const sectionNodes = DESIGN_VAR_GROUPS.map((group)=>{
        const cards = group.vars.map((name)=>{
          const def = DESIGN_VAR_DEF_MAP[name];
          if (!def) return null;
          const baseline = CURRENT_THEME_BASELINE[name] || def.default || '';
          const stored = def.prefKey ? null : (Object.prototype.hasOwnProperty.call(customVars, name) ? customVars[name] : null);
          const hasCustom = def.prefKey
            ? (def.prefKey==='fontScale' ? prefs.fontScale !== THEME_DEFAULT_PREFS.fontScale : false)
            : Object.prototype.hasOwnProperty.call(customVars, name);
          let displayValue;
          if (def.prefKey==='fontScale') displayValue = `${prefs.fontScale}%`;
          else if (stored != null && String(stored).trim()!=='') displayValue = String(stored).trim();
          else displayValue = baseline;

          const resetButton = UI.Button({
            attrs:{
              gkey:'design:var:reset',
              'data-var':name,
              disabled: hasCustom ? undefined : 'disabled',
              class: tw`text-xs`
            },
            variant:'ghost',
            size:'sm'
          }, [TL('designLab.resetVar')]);

          let control = null;
          if (def.type==='color'){
            let colorValue = (stored || baseline || def.default || '').trim();
            if (!/^#([0-9a-f]{3,8})$/i.test(colorValue)){
              colorValue = (def.default && def.default.startsWith('#')) ? def.default : '#6366f1';
            }
            control = D.Containers.Div({ attrs:{ class: tw`flex flex-wrap items-center gap-3` }}, [
              D.Inputs.Input({ attrs:{
                type:'color',
                value: colorValue,
                gkey:'design:var:update',
                'data-var':name,
                'data-editor':'color',
                class: tw`h-10 w-16 rounded-lg border border-[var(--border)] bg-transparent cursor-pointer`
              }}),
              UI.Input({ attrs:{
                value: stored || '',
                placeholder: baseline,
                gkey:'design:var:update',
                'data-var':name,
                'data-editor':'text'
              }})
            ]);
          }
          else if (def.type==='range'){
            let sliderValue;
            if (def.prefKey==='fontScale') sliderValue = prefs.fontScale;
            else {
              const active = stored || baseline || def.default;
              if (typeof active==='string' && def.unit && active.endsWith(def.unit)) sliderValue = parseFloat(active);
              else sliderValue = parseFloat(active);
            }
            if (Number.isNaN(sliderValue)) sliderValue = def.min;
            const attrs = {
              type:'range',
              min:String(def.min),
              max:String(def.max),
              step:String(def.step),
              value:String(sliderValue),
              class: tw`w-full accent-[var(--primary)]`
            };
            if (def.prefKey==='fontScale') attrs.gkey = 'prefs:fontScale';
            else {
              attrs.gkey = 'design:var:update';
              attrs['data-editor'] = 'range';
              if (def.unit) attrs['data-unit'] = def.unit;
            }
            attrs['data-var'] = name;
            control = D.Containers.Div({ attrs:{ class: tw`space-y-2` }}, [
              D.Inputs.Input({ attrs }),
              D.Text.Span({ attrs:{ class: tw`text-xs text-[var(--muted-foreground)]` }}, [
                TL('designLab.currentValue'), ': ', displayValue || '‚Äî'
              ])
            ]);
          }
          else {
            control = UI.Textarea({ attrs:{
              value: stored || '',
              placeholder: baseline,
              rows:'2',
              gkey:'design:var:update',
              'data-var':name,
              'data-editor':'text'
            }});
          }

          return D.Containers.Div({ attrs:{ key:name, class: `${tw`rounded-2xl p-4 space-y-3`} glass-panel` }}, [
            D.Containers.Div({ attrs:{ class: tw`flex items-center justify-between gap-2` }}, [
              D.Text.Span({ attrs:{ class: tw`text-sm font-semibold` }}, [TL(def.labelKey)]),
              resetButton
            ]),
            D.Text.Span({ attrs:{ class: tw`text-xs text-[var(--muted-foreground)]` }}, [
              TL('designLab.defaultValue'), ': ', baseline || '‚Äî'
            ]),
            control
          ]);
        }).filter(Boolean);

        if (!cards.length) return null;
        return D.Containers.Div({ attrs:{ key:`group-${group.id}`, class: tw`space-y-3` }}, [
          D.Containers.Div({ attrs:{ class: tw`space-y-1` }}, [
            D.Text.H4({ attrs:{ class: tw`text-lg font-semibold` }}, [TL(group.labelKey)]),
            D.Text.Span({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL(group.hintKey)])
          ]),
          D.Containers.Div({ attrs:{ class: tw`grid gap-4 md:grid-cols-2` }}, cards)
        ]);
      }).filter(Boolean);

      return UI.Modal({
        open: true,
        title: TL('designLab.title'),
        description: TL('designLab.subtitle'),
        size:'xl',
        closeGkey:'design:lab:close',
        content: D.Containers.Div({ attrs:{ class: tw`space-y-6` }}, [
          D.Containers.Div({ attrs:{ class: tw`space-y-3` }}, [
            D.Text.H4({ attrs:{ class: tw`text-base font-semibold` }}, [TL('designLab.themeTitle')]),
            D.Text.Span({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('designLab.modeHint')]),
            D.Containers.Div({ attrs:{ class: tw`flex flex-wrap items-center gap-3` }}, modeButtons)
          ]),
          ...sectionNodes
        ]),
        actions:[
          UI.Button({ attrs:{ gkey:'design:var:resetAll' }, variant:'ghost', size:'sm' }, [TL('designLab.resetAll')]),
          UI.Button({ attrs:{ gkey:'design:lab:close' }, variant:'soft', size:'sm' }, [TL('settings.close')])
        ]
      });
    }

    function SettingsModal(db){
      if (!db.data.settingsOpen) return null;
      const { TL } = makeLangLookup(db);
      const g = db.data.game;
      const prefs = db.data.themePrefs || INITIAL_THEME_PREFS;
      const lang = db.env.lang || 'ar';
      const backgroundOptions = THEME_BACKGROUND_PRESETS.map((opt)=>({ value: opt.id, label: opt.label[lang] || opt.label.ar }));
      const textOptions = THEME_TEXT_SCHEMES.map((opt)=>({ value: opt.id, label: opt.label[lang] || opt.label.ar }));
      const mode = db.env.theme === 'dark' ? 'dark' : 'light';
      const bgPreset = (THEME_BACKGROUND_MAP[prefs.backgroundId] || THEME_BACKGROUND_MAP[THEME_DEFAULT_PREFS.backgroundId])[mode];

      const musicTile = D.Containers.Div({ attrs:{ class: 'settings-tile' }}, [
        UI.Badge({ attrs:{ class: tw`bg-transparent text-[var(--muted-foreground)]` }, leading:'üéµ', text:TL('game.music') }),
        D.Containers.Div({ attrs:{ class: tw`flex items-center gap-2` }}, [
          UI.Input({ attrs:{ type:'checkbox', checked:g.musicOn, gkey:'game:music:toggle' } }),
          D.Text.Span({ attrs:{ class: tw`text-sm` }}, [TL(g.musicOn ? 'game.musicOn' : 'game.musicOff')])
        ]),
        UI.Select({ attrs:{ gkey:'game:music:select', value:String(g.audioIdx), class: tw`min-w-[200px]` }, options: g.audioList.map((it,i)=>({ value:String(i), label:it.name })) })
      ]);

      const timerTile = D.Containers.Div({ attrs:{ class: 'settings-tile' }}, [
        UI.Badge({ attrs:{ class: tw`bg-transparent text-[var(--muted-foreground)]` }, leading:'‚è±Ô∏è', text:TL('game.timer') }),
        D.Containers.Div({ attrs:{ class: tw`flex items-center gap-2` }}, [
          UI.Input({ attrs:{ type:'checkbox', checked:g.timerOn, gkey:'game:timer:toggle' } }),
          D.Text.Span({ attrs:{ class: tw`text-sm` }}, [TL(g.timerOn ? 'game.timerOn' : 'game.timerOff')])
        ]),
        D.Containers.Div({ attrs:{ class: tw`flex items-center gap-2` }}, [
          UI.Input({ attrs:{ type:'number', min:'5', step:'1', value:String(g.timerSec), style:'width:92px', gkey:'game:timer:value' } }),
          D.Text.Span({ attrs:{ class: tw`text-xs text-[var(--muted-foreground)]` }}, [TL('game.seconds')])
        ])
      ]);

      const themeControls = D.Containers.Div({ attrs:{ class: tw`space-y-4` }}, [
        D.Text.P({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('settings.previewHint')]),
        D.Containers.Div({ attrs:{ class: tw`flex flex-col gap-3 md:flex-row` }}, [
          UI.Select({ attrs:{ gkey:'prefs:background', value:prefs.backgroundId, class: tw`min-w-[220px]` }, options: backgroundOptions }),
          UI.Select({ attrs:{ gkey:'prefs:text', value:prefs.textSchemeId, class: tw`min-w-[220px]` }, options: textOptions })
        ]),
        D.Containers.Div({ attrs:{ class: tw`space-y-2` }}, [
          D.Text.Span({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('settings.fontLabel'), ': ', `${prefs.fontScale}%`]),
          D.Inputs.Input({ attrs:{ type:'range', min:'90', max:'120', step:'5', value:String(prefs.fontScale), gkey:'prefs:fontScale', class: tw`w-full accent-[var(--primary)]` }})
        ]),
        D.Text.Span({ attrs:{ class: tw`text-sm text-[var(--muted-foreground)]` }}, [TL('settings.previewLabel')]),
        D.Containers.Div({ attrs:{ class: tw`rounded-2xl h-36 glass-panel overflow-hidden` }}, [
          D.Containers.Div({ attrs:{ class: tw`w-full h-full` , style:`background:${bgPreset?.gradient || 'var(--page-gradient)'};` }})
        ])
      ]);

      return UI.Modal({
        open: true,
        title: TL('settings.title'),
        description: TL('settings.description'),
        size: 'lg',
        closeGkey: 'ui:settings:close',
        content: D.Containers.Div({ attrs:{ class: tw`space-y-8` }}, [
          D.Containers.Div({ attrs:{ class: tw`space-y-3` }}, [
            D.Text.H4({ attrs:{ class: tw`text-lg font-semibold` }}, [TL('settings.gameSection')]),
            D.Containers.Div({ attrs:{ class: tw`flex flex-col gap-4` }}, [musicTile, timerTile])
          ]),
          D.Containers.Div({ attrs:{ class: tw`space-y-3` }}, [
            D.Text.H4({ attrs:{ class: tw`text-lg font-semibold` }}, [TL('settings.themeSection')]),
            themeControls
          ])
        ]),
        actions: [
          UI.Button({ attrs:{ gkey:'prefs:reset', class: tw`flex-1` }, variant:'ghost', size:'sm' }, [TL('settings.reset')]),
          UI.Button({ attrs:{ gkey:'ui:settings:close', class: tw`flex-1` }, variant:'soft', size:'sm' }, [TL('settings.close')])
        ]
      });
    }

    function MainContent(db){
      const tab = db.data.activeTab;
      if (tab==='readmeBase') return DocPanel(db, 'base');
      if (tab==='readmeTec')  return DocPanel(db, 'tec');
      if (tab==='counter') return CounterPanel(db);
      if (tab==='game')    return GamePanel(db);
      if (tab==='logic')   return LogicGamePanel(db);
      return DocPanel(db, 'base');
    }
    
    // ----------------------------------------------------------------
    // ÿßŸÑÿ±ŸÉŸÜ ÿßŸÑÿ´ÿßŸÜŸä: ÿßŸÑÿπŸÑŸÖ ÿßŸÑŸÅÿ∑ÿ±Ÿä (`database` as DNA)
    // Ÿáÿ∞Ÿá ŸáŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ£ŸàŸÑŸäÿ©ÿå ÿßŸÑÿ¥ŸÅÿ±ÿ© ÿßŸÑŸàÿ±ÿßÿ´Ÿäÿ© ŸÑŸÑÿ™ÿ∑ÿ®ŸäŸÇ.
    // ŸáŸä ÿ™ÿ≠ÿØÿØ ÿßŸÑÿµŸÅÿßÿ™ ÿßŸÑÿ£ŸàŸÑŸäÿ© ŸàÿßŸÑŸáŸäÿ¶ÿ© ÿßŸÑÿ™Ÿä ÿ≥ŸäŸèÿÆŸÑŸÇ ÿπŸÑŸäŸáÿß ÿßŸÑÿ¨ÿ≥ÿØ.
    // ----------------------------------------------------------------
    const database = {
      env:{ theme:'dark', lang:'ar', dir:'rtl' },
      i18n:{ lang:'ar', fallback:'en', dict },
      data:{
        activeTab: 'readmeBase',
        docs: DOCS,
        counter: 0,
        settingsOpen: false,
        themePrefs: { ...INITIAL_THEME_PREFS },
        designLab:{ open:false },
        logicGame:{
          challenge: null,
          options: [],
          selected: null,
          feedback: null
        },
        game:{
          musicOn: true,
          timerOn: true,
          timerSec: 35,
          timeLeft: 35,
          triesMax: 5,
          triesLeft: 5,
          audioList: [
            { name:'Ghost Stories', url:'https://www.fesliyanstudios.com/musicfiles/2020-10-26_-_Ghost_Stories_-_www.FesliyanStudios.com_Steve_Oxen/2020-10-26_-_Ghost_Stories_-_www.FesliyanStudios.com_Steve_Oxen.mp3' },
            { name:'The Unsolved Mystery', url:'https://www.fesliyanstudios.com/musicfiles/2018-07-22_-_The_Unsolved_Murder_-_David_Fesliyan.mp3' },
            { name:'Dark Shadows', url:'https://www.fesliyanstudios.com/musicfiles/2020-06-25_-_Dark_Shadows_-_www.FesliyanStudios.com_David_Fesliyan/2020-06-25_-_Dark_Shadows_-_www.FesliyanStudios.com_David_Fesliyan.mp3' }
          ],
          audioIdx: 0,
          proverb: null,
          guessed: {},
          intervalId: null,
          status: 'idle', // idle | running | won | lost
          revealSolution: false,
          soundStamp: 0,
          feedback: null
        }
      },
      ui:{ modalOpen:false, drawerOpen:false, toasts:[] }
    };

    // ----------------------------------------------------------------
    // ÿπŸÖŸÑŸäÿ© ÿßŸÑÿ™ÿ≥ŸàŸäÿ©: `setBody`
    // ŸáŸÜÿß Ÿäÿ™ŸÖ ÿØŸÖÿ¨ "ÿßŸÑÿ∑ŸäŸÜ" (ÿßŸÑŸÖŸÉŸàŸÜÿßÿ™) ŸÖÿπ "ÿßŸÑÿπŸÑŸÖ ÿßŸÑŸÅÿ∑ÿ±Ÿä" (ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™)
    // ŸÑÿ•ŸÜÿ™ÿßÿ¨ "ÿ¨ÿ≥ÿØ ŸÖŸèÿµŸàŸëŸéÿ±" (Virtual DOM)ÿå ŸàŸáŸà ŸÖÿÆÿ∑ÿ∑ ÿØŸÇŸäŸÇ ŸÑŸÑÿ™ÿ∑ÿ®ŸäŸÇ
    // ŸÇÿ®ŸÑ ÿ£ŸÜ ÿ™ÿØÿ® ŸÅŸäŸá ÿßŸÑÿ≠Ÿäÿßÿ©.
    // ----------------------------------------------------------------
    Mishkah.app.setBody(function(db, h){
      db.head = { title: makeLangLookup(db).TL('app.title') };
      applyThemePrefs(db.data?.themePrefs || INITIAL_THEME_PREFS);
      const overlays = [];
      const modalNode = SettingsModal(db);
      const designLabNode = DesignLabPanel(db);
      if (designLabNode) overlays.push(designLabNode);
      if (modalNode) overlays.push(modalNode);
      if (db.ui?.toasts && db.ui.toasts.length){ overlays.push(UI.ToastHost({ toasts: db.ui.toasts })); }
      return UI.AppRoot({
        shell: D.Containers.Div({ attrs:{ class: `${tw`flex flex-col`} app-shell` }}, [
          HeaderBar(db),
          D.Containers.Div({ attrs:{ class: `${tw`flex-1 w-full`} content-shell` }}, [
            D.Containers.Div({ attrs:{ class: `${tw`w-full mx-auto flex flex-col lg:flex-row gap-8 px-6 pb-12 max-w-[1600px]`}` }}, [
              D.Containers.Aside({ attrs:{ class: `${tw`hidden lg:flex lg:w-[280px] lg:flex-col`}` }}, [
                D.Containers.Div({ attrs:{ class: tw`sticky top-28` }}, [ Sidebar(db) ])
              ]),
              D.Containers.Main({ attrs:{ class: `${tw`flex-1 min-h-0`} main-region`, style:'max-height:100vh;' }}, [
                D.Containers.Div({ attrs:{ class: tw`lg:hidden mb-6` }}, [ Sidebar(db) ]),
                D.Containers.Div({ attrs:{ class: tw`space-y-8` }}, [ MainContent(db) ])
              ])
            ])
          ])
        ]),
        overlays
      });
    });


    // ================================================================
    // ÿßŸÑÿ≤Ÿàÿ¨ ÿßŸÑÿ´ÿßŸÜŸä: ÿßŸÑÿ™ŸÖŸÉŸäŸÜ ŸàÿßŸÑÿ™ŸÉŸÑŸäŸÅ (ŸÜŸÅÿÆ ÿßŸÑÿ±Ÿàÿ≠ ŸàÿßŸÑÿ≠Ÿäÿßÿ©)
    // ŸáŸÜÿß ŸÜŸÖŸÜÿ≠ ÿßŸÑÿ¨ÿ≥ÿØ ÿßŸÑŸÇÿØÿ±ÿ© ÿπŸÑŸâ ÿßŸÑÿ™ŸÅÿßÿπŸÑ ŸàÿßŸÑŸÜŸÖŸà.
    // ================================================================

    // ----------------------------------------------------------------
    // ÿßŸÑÿ±ŸÉŸÜ ÿßŸÑÿ£ŸàŸÑ: ÿßŸÑÿ•ŸäŸÖÿßŸÜ (`database` as State)
    // ŸÜŸÅÿ≥ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™Ÿä ŸÉÿßŸÜÿ™ "DNA"ÿå ÿ£ÿµÿ®ÿ≠ÿ™ ÿßŸÑÿ¢ŸÜ "ÿßŸÑÿ±Ÿàÿ≠" ÿßŸÑÿ≠Ÿäÿ©ÿå
    // ŸàŸáŸä ŸÖÿµÿØÿ± ÿßŸÑÿ≠ŸÇŸäŸÇÿ© ÿßŸÑÿ£Ÿàÿ≠ÿØ ÿßŸÑÿ∞Ÿä ŸäŸáÿ™ÿØŸä ÿ®Ÿá ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ.
    // ----------------------------------------------------------------
    // (ŸÖŸÑÿßÿ≠ÿ∏ÿ©: ÿßŸÑŸÄ `database` ŸÖÿπÿ±ŸÅ ŸÖÿ≥ÿ®ŸÇŸãÿßÿå ŸáŸÜÿß ŸÅŸÇÿ∑ ŸÜŸàÿ∂ÿ≠ ÿØŸàÿ±Ÿá ÿßŸÑÿ¨ÿØŸäÿØ)

    // ----------------------------------------------------------------
    // ÿßŸÑÿ±ŸÉŸÜ ÿßŸÑÿ´ÿßŸÜŸä: ÿßŸÑÿπŸÖŸÑ ÿßŸÑÿµÿßŸÑÿ≠ (`orders`)
    // Ÿáÿ∞Ÿá ŸáŸä ÿßŸÑÿ£ŸàÿßŸÖÿ± ŸàÿßŸÑÿ£ŸÅÿπÿßŸÑ ÿßŸÑÿ™Ÿä ÿ™ÿ≠ÿ±ŸÉ ÿßŸÑÿ¨ÿ≥ÿØ Ÿàÿ™ÿ∫Ÿäÿ± ŸÖŸÜ ÿ≠ÿßŸÑ "ÿ•ŸäŸÖÿßŸÜŸá".
    // ŸÉŸÑ "order" ŸáŸà ÿπŸÖŸÑ ÿµÿßŸÑÿ≠ Ÿäÿ≥ÿ™ÿ¨Ÿäÿ® ŸÑÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸàŸäŸèÿ≠ÿØŸëÿ´ ÿßŸÑÿ≠ÿßŸÑÿ©.
    // ----------------------------------------------------------------
    const KEEP_MAIN_SCROLL = { keepScroll:['.main-region'] };

    const orders = {
      // Routing
      'route:readmeBase':{ on:['click'], gkeys:['route:readmeBase'], handler:(e,ctx)=>{ const s=ctx.getState(); ctx.setState({...s, data:{...s.data, activeTab:'readmeBase' }}); ctx.rebuild(); }},
      'route:readmeTec' :{ on:['click'], gkeys:['route:readmeTec' ], handler:(e,ctx)=>{ const s=ctx.getState(); ctx.setState({...s, data:{...s.data, activeTab:'readmeTec'  }}); ctx.rebuild(); }},
      'route:counter'   :{ on:['click'], gkeys:['route:counter'],   handler:(e,ctx)=>{ const s=ctx.getState(); ctx.setState({...s, data:{...s.data, activeTab:'counter'}}); ctx.rebuild(); }},
      'route:game'      :{ on:['click'], gkeys:['route:game'],      handler:(e,ctx)=>{ const s=ctx.getState(); ctx.setState({...s, data:{...s.data, activeTab:'game'   }}); ctx.rebuild(); }},
      'route:logic'     :{ on:['click'], gkeys:['route:logic'],     handler:(e,ctx)=>{ const s=ctx.getState(); let lg = s.data.logicGame || {}; if (!lg.challenge){ const created = generateLogicChallenge(); lg = { challenge: created, options: created.options, selected:null, feedback:null }; } else { lg = { ...lg }; } ctx.setState({...s, data:{...s.data, activeTab:'logic', logicGame: lg }}); ctx.rebuild(); }},

      // Settings modal & theme preferences
      'ui:settings:toggle':{ on:['change'], gkeys:['ui:settings:toggle'], handler:(e,ctx)=>{ const open = !!(e && e.target && e.target.checked); const s=ctx.getState(); ctx.setState({...s, data:{...s.data, settingsOpen: open }}); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'ui:settings:open'  :{ on:['click'], gkeys:['ui:settings:open'], handler:(e,ctx)=>{ const s=ctx.getState(); if (s.data.settingsOpen) return; ctx.setState({...s, data:{...s.data, settingsOpen:true }}); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'ui:settings:close' :{ on:['click'], gkeys:['ui:settings:close'], handler:(e,ctx)=>{ const s=ctx.getState(); if (!s.data.settingsOpen) return; ctx.setState({...s, data:{...s.data, settingsOpen:false }}); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'theme:sync'        :{ on:['click'], gkeys:['ui:theme-toggle'], handler:(e,ctx)=>{ const prefs = ctx.getState().data?.themePrefs || INITIAL_THEME_PREFS; setTimeout(()=> applyThemePrefs(prefs), 0); }},
      'prefs:background'  :{ on:['change'], gkeys:['prefs:background'], handler:(e,ctx)=>{ const value = e && e.target ? e.target.value : null; if (!value) return; const s=ctx.getState(); const current = normalizeThemePrefs(s.data?.themePrefs || INITIAL_THEME_PREFS); if (current.backgroundId === value) { applyThemePrefs(current); return; } const next = normalizeThemePrefs({ ...current, backgroundId: value }); persistThemePrefs(next); ctx.setState({...s, data:{...s.data, themePrefs: next }}); applyThemePrefs(next); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'prefs:text'        :{ on:['change'], gkeys:['prefs:text'], handler:(e,ctx)=>{ const value = e && e.target ? e.target.value : null; if (!value) return; const s=ctx.getState(); const current = normalizeThemePrefs(s.data?.themePrefs || INITIAL_THEME_PREFS); if (current.textSchemeId === value) { applyThemePrefs(current); return; } const next = normalizeThemePrefs({ ...current, textSchemeId: value }); persistThemePrefs(next); ctx.setState({...s, data:{...s.data, themePrefs: next }}); applyThemePrefs(next); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'prefs:fontScale'   :{ on:['input','change'], gkeys:['prefs:fontScale'], handler:(e,ctx)=>{ const raw = e && e.target ? parseInt(e.target.value,10) : null; if (raw==null || Number.isNaN(raw)) return; const scale = Math.min(120, Math.max(90, raw)); const s=ctx.getState(); const current = normalizeThemePrefs(s.data?.themePrefs || INITIAL_THEME_PREFS); if (current.fontScale === scale) { applyThemePrefs(current); return; } const next = { ...current, fontScale: scale }; persistThemePrefs(next); ctx.setState({...s, data:{...s.data, themePrefs: next }}); applyThemePrefs(next); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'prefs:reset'       :{ on:['click'], gkeys:['prefs:reset'], handler:(e,ctx)=>{ const s=ctx.getState(); const next = { ...THEME_DEFAULT_PREFS }; persistThemePrefs(next); ctx.setState({...s, data:{...s.data, themePrefs: next }}); applyThemePrefs(next); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'design:lab:open'   :{ on:['click'], gkeys:['design:lab:open'], handler:(e,ctx)=>{ const s=ctx.getState(); if (s.data.designLab?.open) return; ctx.setState({...s, data:{...s.data, designLab:{ ...(s.data.designLab||{}), open:true }}}); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'design:lab:close'  :{ on:['click'], gkeys:['design:lab:close'], handler:(e,ctx)=>{ const s=ctx.getState(); if (!s.data.designLab?.open) return; ctx.setState({...s, data:{...s.data, designLab:{ ...(s.data.designLab||{}), open:false }}}); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'design:theme'      :{ on:['click'], gkeys:['design:theme'], handler:(e,ctx)=>{ const btn=e && e.target ? e.target.closest('[data-mode]'):null; const mode=btn?btn.getAttribute('data-mode'):null; if(!mode) return; const s=ctx.getState(); const prefs = normalizeThemePrefs(s.data?.themePrefs || INITIAL_THEME_PREFS); let nextPrefs = prefs; if (mode==='pink'){ nextPrefs = normalizeThemePrefs({ ...prefs, backgroundId:'sunset', textSchemeId:'warm' }); U.twcss.setTheme('light'); } else { U.twcss.setTheme(mode==='dark'?'dark':'light'); }
        const envTheme = mode;
        persistThemePrefs(nextPrefs);
        ctx.setState({...s, env:{ ...(s.env||{}), theme: envTheme }, data:{...s.data, themePrefs: nextPrefs, designLab:{ ...(s.data.designLab||{}), open:true }}});
        applyThemePrefs(nextPrefs);
        ctx.rebuild(KEEP_MAIN_SCROLL);
      }},
      'design:var:update' :{ on:['input','change'], gkeys:['design:var:update'], handler:(e,ctx)=>{
        const target = e && e.target ? e.target : null; if (!target) return;
        const name = target.getAttribute('data-var'); if (!name) return;
        const def = DESIGN_VAR_DEF_MAP[name];
        if (def && def.prefKey) return;
        const editor = target.getAttribute('data-editor') || 'text';
        let value = target.value;
        if (editor==='range'){
          const unit = target.getAttribute('data-unit') || '';
          const num = parseFloat(value);
          if (Number.isNaN(num)) return;
          value = unit ? `${num}${unit}` : String(num);
        } else if (editor==='text'){
          value = typeof value==='string' ? value.trim() : '';
        } else if (editor==='color'){
          if (!value) return;
        }
        const s=ctx.getState();
        const prefs = normalizeThemePrefs(s.data?.themePrefs || INITIAL_THEME_PREFS);
        const customVars = { ...(prefs.customVars || {}) };
        if (editor==='text' && value==='') delete customVars[name]; else customVars[name] = value;
        const next = { ...prefs, customVars };
        persistThemePrefs(next);
        ctx.setState({...s, data:{...s.data, themePrefs: next }});
        applyThemePrefs(next);
        ctx.rebuild(KEEP_MAIN_SCROLL);
      }},
      'design:var:reset'  :{ on:['click'], gkeys:['design:var:reset'], handler:(e,ctx)=>{
        const btn = e && e.target ? e.target.closest('[data-var]') : null; const name = btn ? btn.getAttribute('data-var') : null; if(!name) return;
        const def = DESIGN_VAR_DEF_MAP[name];
        const s=ctx.getState();
        const prefs = normalizeThemePrefs(s.data?.themePrefs || INITIAL_THEME_PREFS);
        let next;
        if (def && def.prefKey==='fontScale') next = { ...prefs, fontScale: THEME_DEFAULT_PREFS.fontScale };
        else {
          const customVars = { ...(prefs.customVars || {}) };
          delete customVars[name];
          next = { ...prefs, customVars };
        }
        persistThemePrefs(next);
        ctx.setState({...s, data:{...s.data, themePrefs: next }});
        applyThemePrefs(next);
        ctx.rebuild(KEEP_MAIN_SCROLL);
      }},
      'design:var:resetAll':{ on:['click'], gkeys:['design:var:resetAll'], handler:(e,ctx)=>{
        const s=ctx.getState();
        const prefs = normalizeThemePrefs(s.data?.themePrefs || INITIAL_THEME_PREFS);
        const next = { ...prefs, customVars:{}, fontScale: THEME_DEFAULT_PREFS.fontScale };
        persistThemePrefs(next);
        ctx.setState({...s, data:{...s.data, themePrefs: next }});
        applyThemePrefs(next);
        ctx.rebuild(KEEP_MAIN_SCROLL);
      }},

      // Logic challenge
      'logic:start'       :{ on:['click'], gkeys:['logic:start'], handler:(e,ctx)=>{ const s=ctx.getState(); const challenge = generateLogicChallenge(); const next = { challenge, options: challenge.options, selected:null, feedback:null }; ctx.setState({...s, data:{...s.data, logicGame: next }}); ctx.rebuild(KEEP_MAIN_SCROLL); }},
      'logic:answer'      :{ on:['click'], gkeys:['logic:answer'], handler:(e,ctx)=>{ const target = e && e.target && e.target.closest ? e.target.closest('[data-choice]') : null; if (!target) return; const choice = parseInt(target.getAttribute('data-choice'),10); if (Number.isNaN(choice)) return; const s=ctx.getState(); const lg = s.data.logicGame || {}; const challenge = lg.challenge; if (!challenge) return; if (lg.feedback && lg.feedback.type==='correct') return; const feedbackType = choice === challenge.answer ? 'correct' : 'wrong'; const feedback = { type: feedbackType, stamp: Date.now() }; const next = { ...lg, selected: choice, feedback }; ctx.setState({...s, data:{...s.data, logicGame: next }}); ctx.rebuild(KEEP_MAIN_SCROLL); }},

      // Counter
      'counter:inc'  :{ on:['click'], gkeys:['counter:inc'],   handler:(e,ctx)=>{ const s=ctx.getState(); ctx.setState({...s, data:{...s.data, counter:s.data.counter+1 }}); ctx.rebuild(); }},
      'counter:dec'  :{ on:['click'], gkeys:['counter:dec'],   handler:(e,ctx)=>{ const s=ctx.getState(); ctx.setState({...s, data:{...s.data, counter:s.data.counter-1 }}); ctx.rebuild(); }},
      'counter:reset':{ on:['click'], gkeys:['counter:reset'], handler:(e,ctx)=>{ const s=ctx.getState(); ctx.setState({...s, data:{...s.data, counter:0 }}); ctx.rebuild(); }},

      // Game toggles
      'game:music:toggle':{ on:['change'], gkeys:['game:music:toggle'], handler:(e,ctx)=>{
        const s=ctx.getState(); const g=s.data.game; const on = !!e.target.checked;
        const stamp = on ? Date.now() : g.soundStamp;
        ctx.setState({...s, data:{...s.data, game:{...g, musicOn:on, soundStamp: stamp }}}); ctx.rebuild(KEEP_MAIN_SCROLL);
      }},
      'game:music:select':{ on:['change'], gkeys:['game:music:select'], handler:(e,ctx)=>{
        const s=ctx.getState(); const g=s.data.game; const idx=Math.max(0,parseInt(e.target.value,10)||0);
        ctx.setState({...s, data:{...s.data, game:{...g, audioIdx: idx, soundStamp: Date.now() }}}); ctx.rebuild(KEEP_MAIN_SCROLL);
      }},
      'game:timer:toggle':{ on:['change'], gkeys:['game:timer:toggle'], handler:(e,ctx)=>{
        const s=ctx.getState(); const g=s.data.game; const on=!!e.target.checked; if(!on && g.intervalId) try{ clearInterval(g.intervalId); }catch(_){ }
        const timeLeft = on ? (g.status==='running' ? (typeof g.timeLeft === 'number' && g.timeLeft>0 ? g.timeLeft : g.timerSec) : g.timerSec) : 0;
        ctx.setState({...s, data:{...s.data, game:{...g, timerOn:on, timeLeft, intervalId: on ? g.intervalId : null }}}); ctx.rebuild(KEEP_MAIN_SCROLL);
      }},
      'game:timer:value':{ on:['input','change'], gkeys:['game:timer:value'], handler:(e,ctx)=>{
        const s=ctx.getState(); const g=s.data.game; const v=Math.max(5, parseInt(e.target.value,10)||g.timerSec);
        const timeLeft = g.timerOn ? (g.status==='running' ? v : v) : g.timeLeft;
        ctx.setState({...s, data:{...s.data, game:{...g, timerSec: v, timeLeft }}}); ctx.rebuild(KEEP_MAIN_SCROLL);
      }},

      // Start / New game
      'game:start':{ on:['click'], gkeys:['game:start'], handler:(e,ctx)=>{
        const s0=ctx.getState(); const g0=s0.data.game; if (g0.intervalId) try{ clearInterval(g0.intervalId); }catch(_){}
        const pv = PROVERBS[Math.floor(Math.random()*PROVERBS.length)];
        const stamp = Date.now();
        const baseTime = g0.timerOn ? g0.timerSec : 0;
        const g1 = { ...g0, proverb: pv, guessed:{}, triesLeft:g0.triesMax, status:'running', timeLeft: baseTime, intervalId:null, revealSolution:false, soundStamp: stamp, feedback:null };
        ctx.setState({ ...s0, data:{ ...s0.data, game:g1 } }); ctx.rebuild(KEEP_MAIN_SCROLL);

        if (g1.timerOn) {
          const iid = setInterval(()=>{
            const s=ctx.getState(); const g=s.data.game; if (g.status!=='running') { clearInterval(iid); return; }
            let timeLeft = typeof g.timeLeft === 'number' ? g.timeLeft - 1 : g.timerSec - 1;
            let triesLeft = g.triesLeft;
            let status = g.status;
            let feedback = g.feedback;
            if (timeLeft <= 0) {
              triesLeft = Math.max(0, triesLeft - 1);
              if (triesLeft === 0) {
                status = 'lost';
                timeLeft = 0;
                if (g.intervalId) try{ clearInterval(g.intervalId); }catch(_){}
                clearInterval(iid);
                feedback = { type:'lose', stamp: Date.now() };
              } else {
                timeLeft = g.timerSec;
                feedback = { type:'wrong', stamp: Date.now() };
              }
            }
            ctx.setState({ ...s, data:{ ...s.data, game:{ ...g, timeLeft, triesLeft, status, feedback, revealSolution: status==='won' ? true : g.revealSolution } }}); ctx.rebuild(KEEP_MAIN_SCROLL);
          }, 1000);
          const s1=ctx.getState(); const g2=s1.data.game;
          ctx.setState({ ...s1, data:{ ...s1.data, game:{ ...g2, intervalId:iid }}}); ctx.rebuild(KEEP_MAIN_SCROLL);
        }
      }},

      // Guess
      'game:guess':{ on:['click'], gkeys:['game:guess'], handler:(e,ctx)=>{
        const btn = e.target.closest && e.target.closest('[data-ch]'); if (!btn) return;
        const L = btn.getAttribute('data-ch'); if (!L) return;
        const s=ctx.getState(); const g=s.data.game; if (g.status!=='running' || !g.proverb) return;

        const guessed = { ...g.guessed, [L]: true };
        const target = g.proverb.t;
        const has = target.split('').some(raw => norm(raw)===L);

        let triesLeft = g.triesLeft, status = g.status;
        if (!has) {
          triesLeft=Math.max(0, triesLeft-1);
          if (triesLeft===0){ status='lost'; if (g.intervalId) try{ clearInterval(g.intervalId); }catch(_){ } }
        }
        else {
          const letters = new Set(target.split('').map(norm).filter(x=>x.trim()!=='' && x!==' '));
          const all = Array.from(letters).every(k => guessed[k]); if (all){ status='won'; if (g.intervalId) try{ clearInterval(g.intervalId); }catch(_){ } }
        }

        const timeLeft = g.timerOn ? (status==='lost' ? 0 : (typeof g.timeLeft === 'number' ? g.timeLeft : g.timerSec)) : 0;
        let feedbackType = has ? 'correct' : 'wrong';
        if (status==='won') feedbackType = 'win';
        if (status==='lost') feedbackType = 'lose';
        const feedback = feedbackType ? { type: feedbackType, stamp: Date.now() } : null;
        ctx.setState({ ...s, data:{ ...s.data, game:{ ...g, guessed, triesLeft, status,
          timeLeft,
          revealSolution: status==='won' ? true : g.revealSolution,
          feedback
        }}}); ctx.rebuild(KEEP_MAIN_SCROLL);
      }},
      'game:reveal':{ on:['click'], gkeys:['game:reveal'], handler:(e,ctx)=>{
        const s=ctx.getState(); const g=s.data.game; if (!g.proverb) return;
        ctx.setState({ ...s, data:{ ...s.data, game:{ ...g, revealSolution:true }}}); ctx.rebuild(KEEP_MAIN_SCROLL);
      }}
    };

    // ----------------------------------------------------------------
    // ÿπŸÖŸÑŸäÿ© ÿßŸÑÿÆŸÑŸÇ: `createApp`
    // ŸáŸÜÿß Ÿäÿ™ŸÖ ÿØŸÖÿ¨ "ÿßŸÑÿ•ŸäŸÖÿßŸÜ" (database) ŸÖÿπ "ÿßŸÑÿπŸÖŸÑ ÿßŸÑÿµÿßŸÑÿ≠" (orders)
    // ŸÑÿ•ŸÜÿ¥ÿßÿ° ŸÉÿßÿ¶ŸÜ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠Ÿä (`app`) ÿßŸÑŸÇÿßÿØÿ± ÿπŸÑŸâ ÿßŸÑÿ™ŸÅÿßÿπŸÑ ŸàÿßŸÑŸÜŸÖŸà.
    // ----------------------------------------------------------------
    const app = Mishkah.app.createApp(database, orders);

    
    // ================================================================
    // ŸÖÿ±ÿ≠ŸÑÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ© ŸàÿßŸÑÿ®ÿπÿ´
    // ================================================================

    // ----------------------------------------------------------------
    // ÿßŸÑÿ•ÿπÿØÿßÿØ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä (Auto)
    // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ®Ÿäÿ¶ÿ© ÿßŸÑŸÖÿ≠Ÿäÿ∑ÿ©: ÿßŸÑÿÆÿ∑Ÿàÿ∑ÿå ÿßŸÑÿ´ŸäŸÖÿßÿ™ÿå ÿßŸÑŸÑÿ∫ÿßÿ™ÿå ŸàÿßŸÑÿ£ŸàÿßŸÖÿ± ÿßŸÑŸÖÿ≥ÿßÿπÿØÿ©.
    // ----------------------------------------------------------------
    const twx = U.twcss.auto(database, app);

    // ----------------------------------------------------------------
    // ÿØŸÖÿ¨ ŸÉŸÑ ÿßŸÑÿ£ŸàÿßŸÖÿ± (setOrders)
    // ŸÜÿ¨ŸÖÿπ ÿ£ŸàÿßŸÖÿ± ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿÆÿßÿµÿ© + ÿ£ŸàÿßŸÖÿ± ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿßŸÑÿ¨ÿßŸáÿ≤ÿ© + ÿ£ŸàÿßŸÖÿ± ÿßŸÑÿ®Ÿäÿ¶ÿ©.
    // ----------------------------------------------------------------
    app.setOrders({ ...orders, ...UI.orders, ...twx.orders });

    // ----------------------------------------------------------------
    // ÿßŸÑÿ®ÿπÿ´ (Mount)
    // ÿßŸÑŸÑÿ≠ÿ∏ÿ© ÿßŸÑÿ™Ÿä Ÿäÿ∏Ÿáÿ± ŸÅŸäŸáÿß ÿßŸÑŸÉÿßÿ¶ŸÜ ÿßŸÑÿ≠Ÿä ÿ•ŸÑŸâ ÿßŸÑÿπÿßŸÑŸÖ (DOM)ÿå
    // ŸÑŸäÿ®ÿØÿ£ ÿ±ÿ≠ŸÑÿ™Ÿá ŸÅŸä ÿßŸÑÿ™ŸÅÿßÿπŸÑ ŸÖÿπ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ.
    // ----------------------------------------------------------------
    app.mount('#app');

  })();
  </script>
</body>
</html>
